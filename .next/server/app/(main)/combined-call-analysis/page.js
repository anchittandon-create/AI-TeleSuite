(()=>{var a={};a.id=3511,a.ids=[3511],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},643:a=>{"use strict";a.exports=require("node:perf_hooks")},1708:a=>{"use strict";a.exports=require("node:process")},2980:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(8808).A)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},3123:(a,b,c)=>{"use strict";c.d(b,{AM:()=>R,hl:()=>T,Wv:()=>S});var d=c(21124),e=c(38301),f=c(87868),g=c(92808),h=c(2332),i=c(7412),j=c(70904),k=c(69998),l=c(75656),m=c(25122),n=c(61611),o=c(29988),p=c(6406),q=c(96425),r=c(11720),s=c(61225),t=c(36409),u="Popover",[v,w]=(0,h.A)(u,[m.Bk]),x=(0,m.Bk)(),[y,z]=v(u),A=a=>{let{__scopePopover:b,children:c,open:f,defaultOpen:g,onOpenChange:h,modal:i=!1}=a,j=x(b),k=e.useRef(null),[n,o]=e.useState(!1),[p,q]=(0,r.i)({prop:f,defaultProp:g??!1,onChange:h,caller:u});return(0,d.jsx)(m.bL,{...j,children:(0,d.jsx)(y,{scope:b,contentId:(0,l.B)(),triggerRef:k,open:p,onOpenChange:q,onOpenToggle:e.useCallback(()=>q(a=>!a),[q]),hasCustomAnchor:n,onCustomAnchorAdd:e.useCallback(()=>o(!0),[]),onCustomAnchorRemove:e.useCallback(()=>o(!1),[]),modal:i,children:c})})};A.displayName=u;var B="PopoverAnchor";e.forwardRef((a,b)=>{let{__scopePopover:c,...f}=a,g=z(B,c),h=x(c),{onCustomAnchorAdd:i,onCustomAnchorRemove:j}=g;return e.useEffect(()=>(i(),()=>j()),[i,j]),(0,d.jsx)(m.Mz,{...h,...f,ref:b})}).displayName=B;var C="PopoverTrigger",D=e.forwardRef((a,b)=>{let{__scopePopover:c,...e}=a,h=z(C,c),i=x(c),j=(0,g.s)(b,h.triggerRef),k=(0,d.jsx)(p.sG.button,{type:"button","aria-haspopup":"dialog","aria-expanded":h.open,"aria-controls":h.contentId,"data-state":P(h.open),...e,ref:j,onClick:(0,f.mK)(a.onClick,h.onOpenToggle)});return h.hasCustomAnchor?k:(0,d.jsx)(m.Mz,{asChild:!0,...i,children:k})});D.displayName=C;var E="PopoverPortal",[F,G]=v(E,{forceMount:void 0}),H=a=>{let{__scopePopover:b,forceMount:c,children:e,container:f}=a,g=z(E,b);return(0,d.jsx)(F,{scope:b,forceMount:c,children:(0,d.jsx)(o.C,{present:c||g.open,children:(0,d.jsx)(n.Z,{asChild:!0,container:f,children:e})})})};H.displayName=E;var I="PopoverContent",J=e.forwardRef((a,b)=>{let c=G(I,a.__scopePopover),{forceMount:e=c.forceMount,...f}=a,g=z(I,a.__scopePopover);return(0,d.jsx)(o.C,{present:e||g.open,children:g.modal?(0,d.jsx)(L,{...f,ref:b}):(0,d.jsx)(M,{...f,ref:b})})});J.displayName=I;var K=(0,q.TL)("PopoverContent.RemoveScroll"),L=e.forwardRef((a,b)=>{let c=z(I,a.__scopePopover),h=e.useRef(null),i=(0,g.s)(b,h),j=e.useRef(!1);return e.useEffect(()=>{let a=h.current;if(a)return(0,s.Eq)(a)},[]),(0,d.jsx)(t.A,{as:K,allowPinchZoom:!0,children:(0,d.jsx)(N,{...a,ref:i,trapFocus:c.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,f.mK)(a.onCloseAutoFocus,a=>{a.preventDefault(),j.current||c.triggerRef.current?.focus()}),onPointerDownOutside:(0,f.mK)(a.onPointerDownOutside,a=>{let b=a.detail.originalEvent,c=0===b.button&&!0===b.ctrlKey;j.current=2===b.button||c},{checkForDefaultPrevented:!1}),onFocusOutside:(0,f.mK)(a.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),M=e.forwardRef((a,b)=>{let c=z(I,a.__scopePopover),f=e.useRef(!1),g=e.useRef(!1);return(0,d.jsx)(N,{...a,ref:b,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:b=>{a.onCloseAutoFocus?.(b),b.defaultPrevented||(f.current||c.triggerRef.current?.focus(),b.preventDefault()),f.current=!1,g.current=!1},onInteractOutside:b=>{a.onInteractOutside?.(b),b.defaultPrevented||(f.current=!0,"pointerdown"===b.detail.originalEvent.type&&(g.current=!0));let d=b.target;c.triggerRef.current?.contains(d)&&b.preventDefault(),"focusin"===b.detail.originalEvent.type&&g.current&&b.preventDefault()}})}),N=e.forwardRef((a,b)=>{let{__scopePopover:c,trapFocus:e,onOpenAutoFocus:f,onCloseAutoFocus:g,disableOutsidePointerEvents:h,onEscapeKeyDown:l,onPointerDownOutside:n,onFocusOutside:o,onInteractOutside:p,...q}=a,r=z(I,c),s=x(c);return(0,j.Oh)(),(0,d.jsx)(k.n,{asChild:!0,loop:!0,trapped:e,onMountAutoFocus:f,onUnmountAutoFocus:g,children:(0,d.jsx)(i.qW,{asChild:!0,disableOutsidePointerEvents:h,onInteractOutside:p,onEscapeKeyDown:l,onPointerDownOutside:n,onFocusOutside:o,onDismiss:()=>r.onOpenChange(!1),children:(0,d.jsx)(m.UC,{"data-state":P(r.open),role:"dialog",id:r.contentId,...s,...q,ref:b,style:{...q.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),O="PopoverClose";function P(a){return a?"open":"closed"}e.forwardRef((a,b)=>{let{__scopePopover:c,...e}=a,g=z(O,c);return(0,d.jsx)(p.sG.button,{type:"button",...e,ref:b,onClick:(0,f.mK)(a.onClick,()=>g.onOpenChange(!1))})}).displayName=O,e.forwardRef((a,b)=>{let{__scopePopover:c,...e}=a,f=x(c);return(0,d.jsx)(m.i3,{...f,...e,ref:b})}).displayName="PopoverArrow";var Q=c(44943);let R=A,S=D,T=e.forwardRef(({className:a,align:b="center",sideOffset:c=4,...e},f)=>(0,d.jsx)(H,{children:(0,d.jsx)(J,{ref:f,align:b,sideOffset:c,className:(0,Q.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...e})}));T.displayName=J.displayName},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:a=>{"use strict";a.exports=require("node:buffer")},7252:a=>{"use strict";a.exports=require("express")},8086:a=>{"use strict";a.exports=require("module")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11648:(a,b,c)=>{"use strict";c.d(b,{q:()=>m});var d=c(91488);c(27806);var e=c(38710),f=c(56571),g=c(87603),h=c(40410);let i=`You are a world-class sales agent. Your goal is to be empathetic, persuasive, and clear, using the provided KB to drive conversion. Your responses must be of the absolute highest quality.

**CRITICAL DIRECTIVE: You MUST base your entire response *exclusively* on the information provided in the structured 'Knowledge Base Context' section below. If a 'USER-SELECTED KB CONTEXT' section is present, it is your PRIMARY source of truth and MUST be prioritized over the general KB.**
**If the provided Knowledge Base is insufficient or lacks specific details, you are authorized to supplement your response by browsing the official product website ({{{brandUrl}}}) and its sub-pages to gather the necessary information. Your primary goal is to be truthful and persuasive.**

**KNOWLEDGE BASE USAGE RULES (NON-NEGOTIABLE):**
1.  For the overall call structure, introduction, and flow, you MUST primarily use the content from any Knowledge Base item categorized as **'Pitch'**.
2.  For factual content about the product, including features, benefits, and value propositions, you MUST exclusively use content from items categorized as **'Product Description'**.
3.  For pricing details, offers, and discounts, you MUST use content from items categorized as **'Pricing'**.
4.  If a category of document is missing, you must state that in the 'notesForAgent' and generate a generic but safe response for that section.
5.  Never invent information. If the KB doesn't provide a detail, do not mention it.

**Clarity and Simplicity Mandate:** The generated pitch must be **crystal clear and easily understandable** for a customer on a phone call. Use simple language, short sentences, and a logical flow. Avoid jargon, complex terms, or overly corporate phrasing. The goal is persuasion through clarity.

**User and Pitch Context:**
- Product: {{product}}
- Brand Name: {{#if brandName}}{{brandName}}{{else}}{{product}}{{/if}}
- Customer Cohort: {{customerCohort}}
- Sales Plan (if specified): {{salesPlan}}
- Offer (if specified): {{offer}}
- Agent Name (if specified): {{agentName}}
- Customer Name (if specified): {{userName}}

{{#if optimizationContext}}
**Optimization Insights (from previous call analysis):**
You MUST use these insights to refine the pitch. Lean into the strengths and address the weaknesses.
\`\`\`
{{{optimizationContext}}}
\`\`\`
{{/if}}

**Knowledge Base Context (Your Sole Source of Information):**
\`\`\`
{{{knowledgeBaseContext}}}
\`\`\`

**Output Generation Rules & Pitch Structure (Strictly follow this):**

You MUST populate EVERY field in the 'GeneratePitchOutputSchema' based *only* on the context above, using the designated sections for their intended purpose.

- **pitchTitle**: A compelling title for the pitch.
- **warmIntroduction**: A brief, friendly opening. Introduce the agent (using "{{agentName}}" if provided, otherwise "your agent") and the brand ("{{brandName}}"). This section **MUST** include a clear **statement of purpose for the call**, derived from a **'Pitch'** category document in the Knowledge Base.
- **personalizedHook**: A hook tailored to the customer cohort, expanding on the reason for the call. This is the most critical part for personalization. Analyze the cohort name (e.g., 'Payment Dropoff', 'Expired Users', 'New Prospect Outreach') and craft an opening that shows you understand their specific situation.
    *   For 'Payment Dropoff' or 'Plan Page Dropoff', reference their recent interest and make it easy to complete the process.
    *   For 'Expired Users', welcome them back and briefly mention what's new or improved, using the KB.
    *   For 'New Prospect Outreach', the hook should be engaging and clearly state the value proposition for a first-time listener.
- **productExplanation**: Explain the product's core value proposition. **Source this information *only* from a 'Product Description' document in the Knowledge Base.** Do not repeat information from the introduction or hook.
- **keyBenefitsAndBundles**: Highlight 2-4 key benefits and any bundles. **Source this information *only* from a 'Product Description' document in the Knowledge Base.**
- **discountOrDealExplanation**: Explain the specific deal or plan availability. Use "<INSERT_PRICE>" for the price. **Source this information *only* from a 'Pricing' document in the Knowledge Base.**
- **objectionHandlingPreviews**: Proactively address 1-2 common objections. **Source this information *only* from 'Rebuttals' or 'Product Description' documents in the Knowledge Base.**
- **finalCallToAction**: A clear, direct call to action that closes with a clear CTA.
- **fullPitchScript**: A complete dialogue integrating all components above. Use the **'Pitch'** documents to guide the overall narrative. Target 450-600 words. Use placeholders like {{agentName}}, {{userName}}, etc.
- **estimatedDuration**: Estimate the speaking time for the agent's script.
- **notesForAgent**: Provide notes for the agent. If the KB was insufficient for any section, mention it here (e.g., "Note: The provided Knowledge Base lacked a 'Pricing' document. The deal section is generic.").

**Tone:** Elite, concise sales script grounded in KB; empathetic and persuasive.
Generate the pitch.
`,j=e.ai.definePrompt({name:"generatePitchPrompt",input:{schema:g.DO},output:{schema:g.sC},prompt:i,model:f.e.MULTIMODAL_PRIMARY,config:{temperature:.4}}),k=e.ai.definePrompt({name:"generatePitchPromptFallback",input:{schema:g.DO},output:{schema:g.sC},prompt:i,model:f.e.MULTIMODAL_SECONDARY,config:{temperature:.35}}),l=e.ai.defineFlow({name:"generatePitchFlow",inputSchema:g.DO,outputSchema:g.sC},async a=>{let b;if(!a.knowledgeBaseContext||a.knowledgeBaseContext.trim().length<50||a.knowledgeBaseContext.includes("No specific knowledge base content found")){let b=`The general Knowledge Base for '${a.product}' is too sparse or missing. The AI cannot generate a meaningful pitch without sufficient product details. Please update the general Knowledge Base with documents for this product.`;return{pitchTitle:"Pitch Generation Failed - Insufficient Knowledge Base",warmIntroduction:b,personalizedHook:"(KB content insufficient to generate distinct content)",productExplanation:"(KB content insufficient to generate distinct content)",keyBenefitsAndBundles:"(KB content insufficient to generate distinct content)",discountOrDealExplanation:"(KB content insufficient to generate distinct content)",objectionHandlingPreviews:"(KB content insufficient to generate distinct content)",finalCallToAction:"(KB content insufficient to generate distinct content)",fullPitchScript:`Pitch generation aborted due to insufficient Knowledge Base content for product '${a.product}'. AI requires detailed KB to create a relevant pitch. ${b}`,estimatedDuration:"N/A",notesForAgent:"Knowledge Base needs to be populated for this product to enable effective pitch generation."}}try{({output:b}=await j(a))}catch(c){console.warn("Primary pitch generation model failed, attempting fallback.",c);try{({output:b}=await k(a))}catch(b){console.error("Fallback pitch generation model also failed.",b);let a=Error(`Primary model error: ${c?.message||c} | Fallback error: ${b?.message||b}`);throw a.name="PitchGenerationModelError",a}}if(!b||!b.fullPitchScript||b.fullPitchScript.length<50)throw console.error("generatePitchFlow: AI returned no or very short pitch script. Input context (truncated):",JSON.stringify({...a,knowledgeBaseContext:a.knowledgeBaseContext.substring(0,200)+"..."},null,2)),Error("AI failed to generate a complete pitch script. The response from the model was empty or too short.");return b});async function m(a){let b=g.DO.safeParse(a);if(!b.success){console.error("Invalid input for generatePitch:",b.error.format());let a=b.error.errors.map(a=>`${a.path.join(".")}: ${a.message}`).join("; ");return{pitchTitle:"Pitch Generation Failed - Invalid Input",warmIntroduction:`Input validation failed: ${a.substring(0,250)}`,personalizedHook:"(Invalid input prevented distinct content generation)",productExplanation:"(Invalid input prevented distinct content generation)",keyBenefitsAndBundles:"(Invalid input prevented distinct content generation)",discountOrDealExplanation:"(Invalid input prevented distinct content generation)",objectionHandlingPreviews:"(Invalid input prevented distinct content generation)",finalCallToAction:"(Invalid input prevented distinct content generation)",fullPitchScript:`Pitch generation aborted due to invalid input. Details: ${a}`,estimatedDuration:"N/A",notesForAgent:"Input validation failed. Check server console for details."}}try{return await l(b.data)}catch(d){console.error("Catastrophic error calling generatePitchFlow:",JSON.stringify(d,Object.getOwnPropertyNames(d),2));let a="Pitch Generation Failed - AI Error",b=`The AI model encountered an error and could not generate the pitch. Details: ${d.message||"An unexpected error occurred"}.`,c=d.message?.toLowerCase()||"";return c.includes("429")||c.includes("quota")?(a="Pitch Generation Failed - API Quota Exceeded",b=`You have exceeded your current API quota for the AI model(s). Please check your billing details or wait for the quota to reset. Original error: ${d.message}`):c.includes("api key")||c.includes("permission denied")?(a="Pitch Generation Failed - API Key/Permission Issue",b=`There seems to be an issue with the API key or permissions for the AI models. Please check server logs and ensure the Google API Key is valid and has access to the Gemini models. Original error: ${d.message}`):c.includes("safety settings")||c.includes("blocked")?(a="Pitch Generation Failed - Content Safety",b=`The pitch generation was blocked, likely due to content safety filters. The combination of your prompt and Knowledge Base content might have triggered this. Original error: ${d.message}`):(c.includes("model returned no response")||c.includes("empty or too short"))&&(a="Pitch Generation Failed - No AI Response",b=`The AI model did not return a valid response, or the response was empty/too short. This might be due to overly restrictive input or a temporary model issue. Original error: ${d.message}`),{pitchTitle:a,warmIntroduction:b,personalizedHook:"(AI error prevented distinct content generation)",productExplanation:"(AI error prevented distinct content generation)",keyBenefitsAndBundles:"(AI error prevented distinct content generation)",discountOrDealExplanation:"(AI error prevented distinct content generation)",objectionHandlingPreviews:"(AI error prevented distinct content generation)",finalCallToAction:"(AI error prevented distinct content generation)",fullPitchScript:`Pitch generation failed due to an AI service error. Details: ${b}. Please check server logs. Input context provided to AI may have caused issues.`,estimatedDuration:"N/A",notesForAgent:"AI service error during pitch generation. Check server logs and KB content quality for the selected product, or the content/format of any directly uploaded file."}}}(0,h.D)([m]),(0,d.A)(m,"408cd05a17b5cea88f672d9bb8d04a22a7b8dee8b8",null)},12412:a=>{"use strict";a.exports=require("assert")},14985:a=>{"use strict";a.exports=require("dns")},16698:a=>{"use strict";a.exports=require("node:async_hooks")},19063:a=>{"use strict";a.exports=require("require-in-the-middle")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19185:a=>{"use strict";a.exports=require("dgram")},19771:a=>{"use strict";a.exports=require("process")},21820:a=>{"use strict";a.exports=require("os")},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},37067:a=>{"use strict";a.exports=require("node:http")},37830:a=>{"use strict";a.exports=require("node:stream/web")},38522:a=>{"use strict";a.exports=require("node:zlib")},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},43027:(a,b,c)=>{"use strict";c.r(b),c.d(b,{"401799effc477a45fbd1aa1777ae81848716958bed":()=>n,"40f0fd89cee17bab62815a07b94e48e73745cf56a8":()=>l});var d=c(91488);c(27806);var e=c(38710),f=c(56571),g=c(87603),h=c(11648),i=c(40410);function j(a,b){return a?a.length<=b?a:a.substring(0,b-3)+"...":"(Transcript not available or was error)"}let k=e.ai.defineFlow({name:"combinedCallScoringAnalysisFlow",inputSchema:g.Jf,outputSchema:g.Pd},async a=>{try{let b=a.callReports.map(a=>{let b=a.scoreOutput;return`
--- Call Report for: ${a.fileName} ---
Overall Score: ${void 0!==b.overallScore?b.overallScore.toFixed(1):"N/A"}
Categorization: ${b.callCategorisation||"N/A"}
Summary: ${j(b.summary,200)}
Strengths: ${b.strengths?.length>0?b.strengths.map(a=>`- ${j(a,100)}`).join("\n"):"None highlighted"}
Areas for Improvement: ${b.areasForImprovement?.length>0?b.areasForImprovement.map(a=>`- ${j(a,100)}`).join("\n"):"None highlighted"}
Red Flags: ${b.redFlags?.length>0?b.redFlags.map(a=>`- ${j(a,100)}`).join("\n"):"None flagged"}
Metrics:
${b.metricScores?.map(a=>`  - ${a.metric}: ${a.score?.toFixed(1)||"N/A"}/5 (Feedback: ${j(a.feedback,100)})`).join("\n")||"  No detailed metrics."}
Transcript (excerpt for context, if needed - do not reproduce full transcripts in your output):
${j(b.transcript,300)}
--- End of Report for ${a.fileName} ---`}).join("\n\n"),c=`
You are an expert call quality supervisor and data analyst, with a laser focus on driving sales revenue and increasing subscription conversions. Your task is to analyze a batch of ${a.callReports.length} individual sales call scoring reports for the product: '${a.product}'.
${a.overallAnalysisGoal?`The specific goal for this batch analysis is: "${a.overallAnalysisGoal}". Please focus your findings accordingly.`:""}

Below are summaries of the individual call reports provided:
${b}

Based on ALL the provided individual call reports, generate a single, comprehensive COMBINED ANALYSIS REPORT. Your primary goal is to provide **actionable insights** that directly answer:
1.  **What specific agent behaviors and script elements are successfully driving revenue and subscription conversions?**
2.  **What specific changes must be made to generate more subscriptions and increase revenue?**

Your report MUST strictly adhere to the 'CombinedCallAnalysisReportSchema' format provided.

Key instructions for your output:
1.  **reportTitle**: e.g., "Combined Call Analysis for ${a.product} - Batch of ${a.callReports.length} Calls".
2.  **productFocus**: This is '${a.product}'.
3.  **numberOfCallsAnalyzed**: This is ${a.callReports.length}.
4.  **averageOverallScore**: Calculate the average overallScore from all valid individual reports (scores > 0).
5.  **overallBatchCategorization**: A qualitative summary for the entire batch (e.g., 'Good overall performance with opportunities in X').
6.  **batchExecutiveSummary**: A concise (2-4 sentences) summary of critical findings. This MUST include a clear statement on **what is driving sales and what is preventing them**, based on the data.
7.  **commonStrengthsObserved**: List 2-4 SPECIFIC, **revenue-driving strengths** frequently observed. Explain *why* these behaviors are leading to conversions (e.g., "Effective use of scarcity in closing led to immediate sign-ups").
8.  **commonAreasForImprovement**: List 2-4 SPECIFIC, **actionable changes required to increase conversions and revenue**. For each point, clearly state what needs to change and *how* that change will lead to better sales outcomes (e.g., "Agents are failing to present bundle value, which needs to be a mandatory talking point to justify the price").
9.  **commonRedFlags**: Review all individual report summaries for 'Red Flags'. If any critical flaws appear more than once that are harming sales, list them here.
10. **keyThemesAndTrends**: Identify 3-5 significant themes. Focus on themes directly related to **sales outcomes** (e.g., 'High conversion when X benefit is mentioned', 'Sales drop-off after price discussion', 'Lack of urgency creation in closing').
11. **metricPerformanceSummary**: For key sales-focused metrics (e.g., Product Presentation, Objection Handling, Closing), summarize batch performance and provide specific observations on what is working or not working for **revenue generation**.
12. **individualCallHighlights (Optional)**: Briefly highlight a few individual calls that exemplify key findings (good or bad).

Be analytical, insightful, and ensure your output is structured JSON conforming to the CombinedCallAnalysisReportSchema. Your entire focus should be on providing clear, actionable insights to improve sales and revenue.
`,{output:d}=await e.ai.generate({model:f.e.MULTIMODAL_PRIMARY,prompt:c,output:{schema:g.Pd,format:"json"},config:{temperature:.3}});if(!d)throw Error("AI failed to generate the combined call analysis report. The model returned no content.");return d}catch(b){return console.error("Error in combinedCallScoringAnalysisFlow:",b),{reportTitle:`Error: Combined Analysis Failed for ${a.product}`,productFocus:a.product,numberOfCallsAnalyzed:a.callReports.length,batchExecutiveSummary:`An error occurred while generating the combined analysis: ${b.message}. Please check the input data and server logs.`,commonStrengthsObserved:[],commonAreasForImprovement:[`Investigate error: ${b.message}`],commonRedFlags:[`System error occurred during analysis: ${b.message}`],keyThemesAndTrends:[{theme:"Error",description:`Analysis failed: ${b.message}`}],metricPerformanceSummary:[{metricName:"Batch Processing",batchPerformanceAssessment:"Failed",specificObservations:b.message}]}}});async function l(a){try{return await k(a)}catch(b){return console.error("Catastrophic error calling combinedCallScoringAnalysisFlow from exported function:",b),{reportTitle:`Critical Error: Combined Analysis System Failure for ${a.product}`,productFocus:a.product,numberOfCallsAnalyzed:a.callReports?.length||0,batchExecutiveSummary:`A critical system error occurred: ${b.message}. Please check server logs.`,commonStrengthsObserved:[],commonAreasForImprovement:["Resolve critical system error."],commonRedFlags:[`Critical system error: ${b.message}`],keyThemesAndTrends:[{theme:"Critical System Error",description:b.message}],metricPerformanceSummary:[{metricName:"System Stability",batchPerformanceAssessment:"Critical Failure",specificObservations:b.message}]}}}let m=e.ai.defineFlow({name:"generateOptimizedPitchesFlow",inputSchema:g.ly,outputSchema:g.s7},async a=>{let b=[],c=`
      **Key Strengths to Emphasize:**
      ${a.analysisReport.commonStrengthsObserved.join("\n- ")}

      **Key Weaknesses to Address/Improve:**
      ${a.analysisReport.commonAreasForImprovement.join("\n- ")}

      **Key Sales-Driving Themes to Incorporate:**
      ${a.analysisReport.keyThemesAndTrends.map(a=>`- ${a.theme}: ${a.description}`).join("\n")}
    `;for(let d of a.cohortsToOptimize)try{let e={product:a.product,customerCohort:d,knowledgeBaseContext:a.knowledgeBaseContext,optimizationContext:c},f=await (0,h.q)(e);if(f.pitchTitle.includes("Failed"))throw Error(`Failed to generate pitch for cohort: ${d}. Reason: ${f.warmIntroduction}`);b.push({cohort:d,pitch:f})}catch(c){console.error(`Failed to generate pitch for cohort ${d}:`,c);let a={pitchTitle:`Error: Failed to generate for ${d}`,warmIntroduction:c.message,fullPitchScript:`Could not generate pitch. Error: ${c.message}`,personalizedHook:"",productExplanation:"",keyBenefitsAndBundles:"",discountOrDealExplanation:"",objectionHandlingPreviews:"",finalCallToAction:"",estimatedDuration:"N/A"};b.push({cohort:d,pitch:a})}return{optimizedPitches:b}});async function n(a){return await m(a)}(0,i.D)([l,n]),(0,d.A)(l,"40f0fd89cee17bab62815a07b94e48e73745cf56a8",null),(0,d.A)(n,"401799effc477a45fbd1aa1777ae81848716958bed",null)},44708:a=>{"use strict";a.exports=require("node:https")},47869:(a,b,c)=>{Promise.resolve().then(c.bind(c,95940))},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},56571:(a,b,c)=>{"use strict";c.d(b,{e:()=>d});let d={MULTIMODAL_PRIMARY:"googleai/gemini-2.0-flash",MULTIMODAL_SECONDARY:"googleai/gemini-1.5-pro",TEXT_ONLY:"googleai/gemini-2.0-flash"}},56801:a=>{"use strict";a.exports=require("import-in-the-middle")},57075:a=>{"use strict";a.exports=require("node:stream")},57265:a=>{"use strict";a.exports=require("child_process")},57975:a=>{"use strict";a.exports=require("node:util")},62497:(a,b,c)=>{"use strict";c.d(b,{S:()=>E});var d=c(21124),e=c(38301),f=c(92808),g=c(2332),h=c(87868),i=c(11720),j=c(87969),k=c(96386),l=c(29988),m=c(6406),n="Checkbox",[o,p]=(0,g.A)(n),[q,r]=o(n);function s(a){let{__scopeCheckbox:b,checked:c,children:f,defaultChecked:g,disabled:h,form:j,name:k,onCheckedChange:l,required:m,value:o="on",internal_do_not_use_render:p}=a,[r,s]=(0,i.i)({prop:c,defaultProp:g??!1,onChange:l,caller:n}),[t,u]=e.useState(null),[v,w]=e.useState(null),x=e.useRef(!1),y=!t||!!j||!!t.closest("form"),z={checked:r,disabled:h,setChecked:s,control:t,setControl:u,name:k,form:j,value:o,hasConsumerStoppedPropagationRef:x,required:m,defaultChecked:!A(g)&&g,isFormControl:y,bubbleInput:v,setBubbleInput:w};return(0,d.jsx)(q,{scope:b,...z,children:"function"==typeof p?p(z):f})}var t="CheckboxTrigger",u=e.forwardRef(({__scopeCheckbox:a,onKeyDown:b,onClick:c,...g},i)=>{let{control:j,value:k,disabled:l,checked:n,required:o,setControl:p,setChecked:q,hasConsumerStoppedPropagationRef:s,isFormControl:u,bubbleInput:v}=r(t,a),w=(0,f.s)(i,p),x=e.useRef(n);return e.useEffect(()=>{let a=j?.form;if(a){let b=()=>q(x.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[j,q]),(0,d.jsx)(m.sG.button,{type:"button",role:"checkbox","aria-checked":A(n)?"mixed":n,"aria-required":o,"data-state":B(n),"data-disabled":l?"":void 0,disabled:l,value:k,...g,ref:w,onKeyDown:(0,h.mK)(b,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,h.mK)(c,a=>{q(a=>!!A(a)||!a),v&&u&&(s.current=a.isPropagationStopped(),s.current||a.stopPropagation())})})});u.displayName=t;var v=e.forwardRef((a,b)=>{let{__scopeCheckbox:c,name:e,checked:f,defaultChecked:g,required:h,disabled:i,value:j,onCheckedChange:k,form:l,...m}=a;return(0,d.jsx)(s,{__scopeCheckbox:c,checked:f,defaultChecked:g,disabled:i,required:h,onCheckedChange:k,name:e,form:l,value:j,internal_do_not_use_render:({isFormControl:a})=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(u,{...m,ref:b,__scopeCheckbox:c}),a&&(0,d.jsx)(z,{__scopeCheckbox:c})]})})});v.displayName=n;var w="CheckboxIndicator",x=e.forwardRef((a,b)=>{let{__scopeCheckbox:c,forceMount:e,...f}=a,g=r(w,c);return(0,d.jsx)(l.C,{present:e||A(g.checked)||!0===g.checked,children:(0,d.jsx)(m.sG.span,{"data-state":B(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:b,style:{pointerEvents:"none",...a.style}})})});x.displayName=w;var y="CheckboxBubbleInput",z=e.forwardRef(({__scopeCheckbox:a,...b},c)=>{let{control:g,hasConsumerStoppedPropagationRef:h,checked:i,defaultChecked:l,required:n,disabled:o,name:p,value:q,form:s,bubbleInput:t,setBubbleInput:u}=r(y,a),v=(0,f.s)(c,u),w=(0,j.Z)(i),x=(0,k.X)(g);e.useEffect(()=>{if(!t)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,b=!h.current;if(w!==i&&a){let c=new Event("click",{bubbles:b});t.indeterminate=A(i),a.call(t,!A(i)&&i),t.dispatchEvent(c)}},[t,w,i,h]);let z=e.useRef(!A(i)&&i);return(0,d.jsx)(m.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??z.current,required:n,disabled:o,name:p,value:q,form:s,...b,tabIndex:-1,ref:v,style:{...b.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function A(a){return"indeterminate"===a}function B(a){return A(a)?"indeterminate":a?"checked":"unchecked"}z.displayName=y;var C=c(8015),D=c(44943);let E=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(v,{ref:c,className:(0,D.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...b,children:(0,d.jsx)(x,{className:(0,D.cn)("flex items-center justify-center text-current"),children:(0,d.jsx)(C.A,{className:"h-4 w-4"})})}));E.displayName=v.displayName},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:a=>{"use strict";a.exports=require("node:fs")},73136:a=>{"use strict";a.exports=require("node:url")},73496:a=>{"use strict";a.exports=require("http2")},73566:a=>{"use strict";a.exports=require("worker_threads")},74075:a=>{"use strict";a.exports=require("zlib")},74998:a=>{"use strict";a.exports=require("perf_hooks")},76760:a=>{"use strict";a.exports=require("node:path")},77030:a=>{"use strict";a.exports=require("node:net")},77598:a=>{"use strict";a.exports=require("node:crypto")},77725:(a,b,c)=>{Promise.resolve().then(c.bind(c,88230))},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},79748:a=>{"use strict";a.exports=require("fs/promises")},81630:a=>{"use strict";a.exports=require("http")},84297:a=>{"use strict";a.exports=require("async_hooks")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},88230:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/combined-call-analysis/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/combined-call-analysis/page.tsx","default")},91645:a=>{"use strict";a.exports=require("net")},94735:a=>{"use strict";a.exports=require("events")},95940:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>aK});var d=c(21124),e=c(38301),f=c(85708);let g=(0,f.createServerReference)("40f0fd89cee17bab62815a07b94e48e73745cf56a8",f.callServer,void 0,f.findSourceMapURL,"analyzeCallBatch"),h=(0,f.createServerReference)("401799effc477a45fbd1aa1777ae81848716958bed",f.callServer,void 0,f.findSourceMapURL,"generateOptimizedPitches");var i=c(61882),j=c(45019),k=c(64772),l=c(96764),m=c(99388),n=c(68334),o=c(99599),p=c(2980),q=c(8808);let r=(0,q.A)("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);var s=c(37448),t=c(90629),u=c(89266),v=c(62186),w=c(35284),x=c(68120),y=c(45608),z=c(68254),A=c(7952),B=c(44183),C=c(89308),D=c(40068),E=c(90275),F=c(84407),G=c(49113),H=c(8015);let I=(0,q.A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var J=c(99187),K=c(3123),L=/[\\\/_+.#"@\[\(\{&]/,M=/[\\\/_+.#"@\[\(\{&]/g,N=/[\s-]/,O=/[\s-]/g;function P(a){return a.toLowerCase().replace(O," ")}var Q=c(39641),R=c(6406),S=c(75656),T=c(92808),U='[cmdk-group=""]',V='[cmdk-group-items=""]',W='[cmdk-item=""]',X=`${W}:not([aria-disabled="true"])`,Y="cmdk-item-select",Z="data-value",$=(a,b,c)=>(function(a,b,c){return function a(b,c,d,e,f,g,h){if(g===c.length)return f===b.length?1:.99;var i=`${f},${g}`;if(void 0!==h[i])return h[i];for(var j,k,l,m,n=e.charAt(g),o=d.indexOf(n,f),p=0;o>=0;)(j=a(b,c,d,e,o+1,g+1,h))>p&&(o===f?j*=1:L.test(b.charAt(o-1))?(j*=.8,(l=b.slice(f,o-1).match(M))&&f>0&&(j*=Math.pow(.999,l.length))):N.test(b.charAt(o-1))?(j*=.9,(m=b.slice(f,o-1).match(O))&&f>0&&(j*=Math.pow(.999,m.length))):(j*=.17,f>0&&(j*=Math.pow(.999,o-f))),b.charAt(o)!==c.charAt(g)&&(j*=.9999)),(j<.1&&d.charAt(o-1)===e.charAt(g+1)||e.charAt(g+1)===e.charAt(g)&&d.charAt(o-1)!==e.charAt(g))&&.1*(k=a(b,c,d,e,o+1,g+2,h))>j&&(j=.1*k),j>p&&(p=j),o=d.indexOf(n,o+1);return h[i]=p,p}(a=c&&c.length>0?`${a+" "+c.join(" ")}`:a,b,P(a),P(b),0,0,{})})(a,b,c),_=e.createContext(void 0),aa=()=>e.useContext(_),ab=e.createContext(void 0),ac=()=>e.useContext(ab),ad=e.createContext(void 0),ae=e.forwardRef((a,b)=>{let c=ao(()=>{var b,c;return{search:"",value:null!=(c=null!=(b=a.value)?b:a.defaultValue)?c:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),d=ao(()=>new Set),f=ao(()=>new Map),g=ao(()=>new Map),h=ao(()=>new Set),i=am(a),{label:j,children:k,value:l,onValueChange:m,filter:n,shouldFilter:o,loop:p,disablePointerSelection:q=!1,vimBindings:r=!0,...s}=a,t=(0,S.B)(),u=(0,S.B)(),v=(0,S.B)(),w=e.useRef(null),x=ar();an(()=>{if(void 0!==l){let a=l.trim();c.current.value=a,y.emit()}},[l]),an(()=>{x(6,E)},[]);let y=e.useMemo(()=>({subscribe:a=>(h.current.add(a),()=>h.current.delete(a)),snapshot:()=>c.current,setState:(a,b,d)=>{var e,f,g,h;if(!Object.is(c.current[a],b)){if(c.current[a]=b,"search"===a)D(),B(),x(1,C);else if("value"===a){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let a=document.getElementById(v);a?a.focus():null==(e=document.getElementById(t))||e.focus()}if(x(7,()=>{var a;c.current.selectedItemId=null==(a=F())?void 0:a.id,y.emit()}),d||x(5,E),(null==(f=i.current)?void 0:f.value)!==void 0){null==(h=(g=i.current).onValueChange)||h.call(g,null!=b?b:"");return}}y.emit()}},emit:()=>{h.current.forEach(a=>a())}}),[]),z=e.useMemo(()=>({value:(a,b,d)=>{var e;b!==(null==(e=g.current.get(a))?void 0:e.value)&&(g.current.set(a,{value:b,keywords:d}),c.current.filtered.items.set(a,A(b,d)),x(2,()=>{B(),y.emit()}))},item:(a,b)=>(d.current.add(a),b&&(f.current.has(b)?f.current.get(b).add(a):f.current.set(b,new Set([a]))),x(3,()=>{D(),B(),c.current.value||C(),y.emit()}),()=>{g.current.delete(a),d.current.delete(a),c.current.filtered.items.delete(a);let b=F();x(4,()=>{D(),(null==b?void 0:b.getAttribute("id"))===a&&C(),y.emit()})}),group:a=>(f.current.has(a)||f.current.set(a,new Set),()=>{g.current.delete(a),f.current.delete(a)}),filter:()=>i.current.shouldFilter,label:j||a["aria-label"],getDisablePointerSelection:()=>i.current.disablePointerSelection,listId:t,inputId:v,labelId:u,listInnerRef:w}),[]);function A(a,b){var d,e;let f=null!=(e=null==(d=i.current)?void 0:d.filter)?e:$;return a?f(a,c.current.search,b):0}function B(){if(!c.current.search||!1===i.current.shouldFilter)return;let a=c.current.filtered.items,b=[];c.current.filtered.groups.forEach(c=>{let d=f.current.get(c),e=0;d.forEach(b=>{e=Math.max(a.get(b),e)}),b.push([c,e])});let d=w.current;G().sort((b,c)=>{var d,e;let f=b.getAttribute("id"),g=c.getAttribute("id");return(null!=(d=a.get(g))?d:0)-(null!=(e=a.get(f))?e:0)}).forEach(a=>{let b=a.closest(V);b?b.appendChild(a.parentElement===b?a:a.closest(`${V} > *`)):d.appendChild(a.parentElement===d?a:a.closest(`${V} > *`))}),b.sort((a,b)=>b[1]-a[1]).forEach(a=>{var b;let c=null==(b=w.current)?void 0:b.querySelector(`${U}[${Z}="${encodeURIComponent(a[0])}"]`);null==c||c.parentElement.appendChild(c)})}function C(){let a=G().find(a=>"true"!==a.getAttribute("aria-disabled")),b=null==a?void 0:a.getAttribute(Z);y.setState("value",b||void 0)}function D(){var a,b,e,h;if(!c.current.search||!1===i.current.shouldFilter){c.current.filtered.count=d.current.size;return}c.current.filtered.groups=new Set;let j=0;for(let f of d.current){let d=A(null!=(b=null==(a=g.current.get(f))?void 0:a.value)?b:"",null!=(h=null==(e=g.current.get(f))?void 0:e.keywords)?h:[]);c.current.filtered.items.set(f,d),d>0&&j++}for(let[a,b]of f.current)for(let d of b)if(c.current.filtered.items.get(d)>0){c.current.filtered.groups.add(a);break}c.current.filtered.count=j}function E(){var a,b,c;let d=F();d&&((null==(a=d.parentElement)?void 0:a.firstChild)===d&&(null==(c=null==(b=d.closest(U))?void 0:b.querySelector('[cmdk-group-heading=""]'))||c.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function F(){var a;return null==(a=w.current)?void 0:a.querySelector(`${W}[aria-selected="true"]`)}function G(){var a;return Array.from((null==(a=w.current)?void 0:a.querySelectorAll(X))||[])}function H(a){let b=G()[a];b&&y.setState("value",b.getAttribute(Z))}function I(a){var b;let c=F(),d=G(),e=d.findIndex(a=>a===c),f=d[e+a];null!=(b=i.current)&&b.loop&&(f=e+a<0?d[d.length-1]:e+a===d.length?d[0]:d[e+a]),f&&y.setState("value",f.getAttribute(Z))}function J(a){let b=F(),c=null==b?void 0:b.closest(U),d;for(;c&&!d;)d=null==(c=a>0?function(a,b){let c=a.nextElementSibling;for(;c;){if(c.matches(b))return c;c=c.nextElementSibling}}(c,U):function(a,b){let c=a.previousElementSibling;for(;c;){if(c.matches(b))return c;c=c.previousElementSibling}}(c,U))?void 0:c.querySelector(X);d?y.setState("value",d.getAttribute(Z)):I(a)}let K=()=>H(G().length-1),L=a=>{a.preventDefault(),a.metaKey?K():a.altKey?J(1):I(1)},M=a=>{a.preventDefault(),a.metaKey?H(0):a.altKey?J(-1):I(-1)};return e.createElement(R.sG.div,{ref:b,tabIndex:-1,...s,"cmdk-root":"",onKeyDown:a=>{var b;null==(b=s.onKeyDown)||b.call(s,a);let c=a.nativeEvent.isComposing||229===a.keyCode;if(!(a.defaultPrevented||c))switch(a.key){case"n":case"j":r&&a.ctrlKey&&L(a);break;case"ArrowDown":L(a);break;case"p":case"k":r&&a.ctrlKey&&M(a);break;case"ArrowUp":M(a);break;case"Home":a.preventDefault(),H(0);break;case"End":a.preventDefault(),K();break;case"Enter":{a.preventDefault();let b=F();if(b){let a=new Event(Y);b.dispatchEvent(a)}}}}},e.createElement("label",{"cmdk-label":"",htmlFor:z.inputId,id:z.labelId,style:at},j),as(a,a=>e.createElement(ab.Provider,{value:y},e.createElement(_.Provider,{value:z},a))))}),af=e.forwardRef((a,b)=>{var c,d;let f=(0,S.B)(),g=e.useRef(null),h=e.useContext(ad),i=aa(),j=am(a),k=null!=(d=null==(c=j.current)?void 0:c.forceMount)?d:null==h?void 0:h.forceMount;an(()=>{if(!k)return i.item(f,null==h?void 0:h.id)},[k]);let l=aq(f,g,[a.value,a.children,g],a.keywords),m=ac(),n=ap(a=>a.value&&a.value===l.current),o=ap(a=>!!k||!1===i.filter()||!a.search||a.filtered.items.get(f)>0);function p(){var a,b;q(),null==(b=(a=j.current).onSelect)||b.call(a,l.current)}function q(){m.setState("value",l.current,!0)}if(e.useEffect(()=>{let b=g.current;if(!(!b||a.disabled))return b.addEventListener(Y,p),()=>b.removeEventListener(Y,p)},[o,a.onSelect,a.disabled]),!o)return null;let{disabled:r,value:s,onSelect:t,forceMount:u,keywords:v,...w}=a;return e.createElement(R.sG.div,{ref:(0,T.t)(g,b),...w,id:f,"cmdk-item":"",role:"option","aria-disabled":!!r,"aria-selected":!!n,"data-disabled":!!r,"data-selected":!!n,onPointerMove:r||i.getDisablePointerSelection()?void 0:q,onClick:r?void 0:p},a.children)}),ag=e.forwardRef((a,b)=>{let{heading:c,children:d,forceMount:f,...g}=a,h=(0,S.B)(),i=e.useRef(null),j=e.useRef(null),k=(0,S.B)(),l=aa(),m=ap(a=>!!f||!1===l.filter()||!a.search||a.filtered.groups.has(h));an(()=>l.group(h),[]),aq(h,i,[a.value,a.heading,j]);let n=e.useMemo(()=>({id:h,forceMount:f}),[f]);return e.createElement(R.sG.div,{ref:(0,T.t)(i,b),...g,"cmdk-group":"",role:"presentation",hidden:!m||void 0},c&&e.createElement("div",{ref:j,"cmdk-group-heading":"","aria-hidden":!0,id:k},c),as(a,a=>e.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":c?k:void 0},e.createElement(ad.Provider,{value:n},a))))}),ah=e.forwardRef((a,b)=>{let{alwaysRender:c,...d}=a,f=e.useRef(null),g=ap(a=>!a.search);return c||g?e.createElement(R.sG.div,{ref:(0,T.t)(f,b),...d,"cmdk-separator":"",role:"separator"}):null}),ai=e.forwardRef((a,b)=>{let{onValueChange:c,...d}=a,f=null!=a.value,g=ac(),h=ap(a=>a.search),i=ap(a=>a.selectedItemId),j=aa();return e.useEffect(()=>{null!=a.value&&g.setState("search",a.value)},[a.value]),e.createElement(R.sG.input,{ref:b,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":j.listId,"aria-labelledby":j.labelId,"aria-activedescendant":i,id:j.inputId,type:"text",value:f?a.value:h,onChange:a=>{f||g.setState("search",a.target.value),null==c||c(a.target.value)}})}),aj=e.forwardRef((a,b)=>{let{children:c,label:d="Suggestions",...f}=a,g=e.useRef(null),h=e.useRef(null),i=ap(a=>a.selectedItemId),j=aa();return e.useEffect(()=>{if(h.current&&g.current){let a=h.current,b=g.current,c,d=new ResizeObserver(()=>{c=requestAnimationFrame(()=>{let c=a.offsetHeight;b.style.setProperty("--cmdk-list-height",c.toFixed(1)+"px")})});return d.observe(a),()=>{cancelAnimationFrame(c),d.unobserve(a)}}},[]),e.createElement(R.sG.div,{ref:(0,T.t)(g,b),...f,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":i,"aria-label":d,id:j.listId},as(a,a=>e.createElement("div",{ref:(0,T.t)(h,j.listInnerRef),"cmdk-list-sizer":""},a)))}),ak=e.forwardRef((a,b)=>{let{open:c,onOpenChange:d,overlayClassName:f,contentClassName:g,container:h,...i}=a;return e.createElement(Q.bL,{open:c,onOpenChange:d},e.createElement(Q.ZL,{container:h},e.createElement(Q.hJ,{"cmdk-overlay":"",className:f}),e.createElement(Q.UC,{"aria-label":a.label,"cmdk-dialog":"",className:g},e.createElement(ae,{ref:b,...i}))))}),al=Object.assign(ae,{List:aj,Item:af,Input:ai,Group:ag,Separator:ah,Dialog:ak,Empty:e.forwardRef((a,b)=>ap(a=>0===a.filtered.count)?e.createElement(R.sG.div,{ref:b,...a,"cmdk-empty":"",role:"presentation"}):null),Loading:e.forwardRef((a,b)=>{let{progress:c,children:d,label:f="Loading...",...g}=a;return e.createElement(R.sG.div,{ref:b,...g,"cmdk-loading":"",role:"progressbar","aria-valuenow":c,"aria-valuemin":0,"aria-valuemax":100,"aria-label":f},as(a,a=>e.createElement("div",{"aria-hidden":!0},a)))})});function am(a){let b=e.useRef(a);return an(()=>{b.current=a}),b}var an=e.useEffect;function ao(a){let b=e.useRef();return void 0===b.current&&(b.current=a()),b}function ap(a){let b=ac(),c=()=>a(b.snapshot());return e.useSyncExternalStore(b.subscribe,c,c)}function aq(a,b,c,d=[]){let f=e.useRef(),g=aa();return an(()=>{var e;let h=(()=>{var a;for(let b of c){if("string"==typeof b)return b.trim();if("object"==typeof b&&"current"in b)return b.current?null==(a=b.current.textContent)?void 0:a.trim():f.current}})(),i=d.map(a=>a.trim());g.value(a,h,i),null==(e=b.current)||e.setAttribute(Z,h),f.current=h}),f}var ar=()=>{let[a,b]=e.useState(),c=ao(()=>new Map);return an(()=>{c.current.forEach(a=>a()),c.current=new Map},[a]),(a,d)=>{c.current.set(a,d),b({})}};function as({asChild:a,children:b},c){let d;return a&&e.isValidElement(b)?e.cloneElement("function"==typeof(d=b.type)?d(b.props):"render"in d?d.render(b.props):b,{ref:b.ref},c(b.props.children)):c(b)}var at={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};let au=(0,q.A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var av=c(44943);let aw=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(al,{ref:c,className:(0,av.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...b}));aw.displayName=al.displayName;let ax=e.forwardRef(({className:a,...b},c)=>(0,d.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,d.jsx)(au,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,d.jsx)(al.Input,{ref:c,className:(0,av.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...b})]}));ax.displayName=al.Input.displayName;let ay=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(al.List,{ref:c,className:(0,av.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...b}));ay.displayName=al.List.displayName;let az=e.forwardRef((a,b)=>(0,d.jsx)(al.Empty,{ref:b,className:"py-6 text-center text-sm",...a}));az.displayName=al.Empty.displayName;let aA=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(al.Group,{ref:c,className:(0,av.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...b}));aA.displayName=al.Group.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(al.Separator,{ref:c,className:(0,av.cn)("-mx-1 h-px bg-border",a),...b})).displayName=al.Separator.displayName;let aB=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(al.Item,{ref:c,className:(0,av.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",a),...b}));aB.displayName=al.Item.displayName;var aC=c(62497);function aD({isOpen:a,onClose:b,product:c,optimizedPitches:f,onSubmit:g,isLoading:h}){let{addFile:i}=(0,B.J)(),{toast:j}=(0,s.dj)(),[k,l]=(0,e.useState)([]),{getProductByName:m}=(0,A.G)(),n=m(c),o=n?.customerCohorts||[],[p,q]=(0,e.useState)(o),t=f&&f.optimizedPitches.every(a=>a.pitch.pitchTitle.includes("Error"));return(0,d.jsx)(D.lG,{open:a,onOpenChange:b,children:(0,d.jsxs)(D.Cf,{className:"sm:max-w-4xl md:max-w-5xl lg:max-w-6xl max-h-[90vh] flex flex-col p-0",children:[(0,d.jsxs)(D.c7,{className:"p-4 pb-3 border-b sticky top-0 bg-background z-10",children:[(0,d.jsxs)(D.L3,{className:"text-xl text-primary",children:["Optimized Sales Pitches for '",c,"'"]}),(0,d.jsx)(D.rr,{children:"Based on the combined call analysis, generate and review optimized pitches for selected customer cohorts."})]}),(0,d.jsxs)("div",{className:"flex-grow p-4 overflow-y-auto",children:[(0,d.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/20 space-y-3 mb-4",children:[(0,d.jsxs)("h4",{className:"font-semibold text-foreground flex items-center",children:[(0,d.jsx)(F.A,{className:"mr-2 h-5 w-5 text-primary"}),"Select Cohorts to Generate"]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(aE,{allCohorts:o,selectedCohorts:p,onSelectionChange:q}),(0,d.jsx)(w.$,{onClick:()=>g(p),disabled:h||0===p.length,children:h?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(G.A,{className:"mr-2 h-4 w-4 animate-spin"})," Generating..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(r,{className:"mr-2 h-4 w-4"})," Generate for (",p.length,")"]})})]})]}),h&&(0,d.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,d.jsx)(G.A,{className:"h-8 w-8 animate-spin text-primary"})}),f&&(t?(0,d.jsxs)("div",{className:"text-center py-10 text-muted-foreground",children:[(0,d.jsx)("p",{children:"Could not generate optimized pitches due to an error."}),(0,d.jsx)("p",{className:"text-xs mt-1",children:f.optimizedPitches[0]?.pitch.warmIntroduction||"Check server logs for more details."})]}):(0,d.jsx)(C.nD,{type:"multiple",defaultValue:[f.optimizedPitches[0]?.cohort],className:"w-full space-y-2",children:f.optimizedPitches.map(({cohort:a,pitch:b},e)=>(0,d.jsxs)(C.As,{value:a,children:[(0,d.jsx)(C.$m,{className:"text-md font-semibold hover:no-underline bg-muted/30 px-4 py-2 rounded-md",children:(0,d.jsxs)("div",{className:"flex justify-between items-center w-full pr-2",children:[(0,d.jsxs)("span",{children:["Cohort: ",a]}),b.pitchTitle.includes("Error")?(0,d.jsx)(J.E,{variant:"destructive",children:"Error"}):(0,d.jsxs)(w.$,{size:"sm",variant:"outline",onClick:d=>{let e;d.stopPropagation();let f=(e=`Title: ${b.pitchTitle}

## Full Script
${b.fullPitchScript}

## Introduction
${b.warmIntroduction}

## Hook
${b.personalizedHook}

## Product Explanation
${b.productExplanation}

## Key Benefits
${b.keyBenefitsAndBundles}

## Offer
${b.discountOrDealExplanation}

## Objection Previews
${b.objectionHandlingPreviews}

## Call to Action
${b.finalCallToAction}

`,b.notesForAgent&&(e+=`## Agent Notes
${b.notesForAgent}
`),e),g=`Optimized Pitch: ${b.pitchTitle}`;i({name:g,type:"text/plain",size:f.length,product:c,persona:a,category:"Pitch",textContent:f,isTextEntry:!0}),l(b=>[...b,a]),j({title:"Pitch Saved to Knowledge Base",description:`"${g}" saved for cohort: ${a}.`})},disabled:k.includes(a),children:[k.includes(a)?(0,d.jsx)(H.A,{className:"mr-2 h-4 w-4"}):(0,d.jsx)(I,{className:"mr-2 h-4 w-4"}),k.includes(a)?"Saved":"Save to KB"]})]})}),(0,d.jsx)(C.ub,{className:"pt-3 px-1",children:(0,d.jsx)(E.r,{pitch:b})})]},`${a}-${e}`))}))]}),(0,d.jsx)(D.Es,{className:"p-3 border-t bg-muted/50 sticky bottom-0",children:(0,d.jsx)(w.$,{onClick:b,size:"sm",children:"Close"})})]})})}let aE=({allCohorts:a,selectedCohorts:b,onSelectionChange:c})=>(0,d.jsxs)(K.AM,{children:[(0,d.jsx)(K.Wv,{asChild:!0,children:(0,d.jsxs)(w.$,{variant:"outline",className:"w-[250px] justify-start",children:[(0,d.jsx)(F.A,{className:"mr-2 h-4 w-4"}),b.length>0?`${b.length} selected`:"Select cohorts..."]})}),(0,d.jsx)(K.hl,{className:"w-[250px] p-0",align:"start",children:(0,d.jsxs)(aw,{children:[(0,d.jsx)(ax,{placeholder:"Filter cohorts..."}),(0,d.jsxs)(ay,{children:[(0,d.jsx)(az,{children:"No cohorts found."}),(0,d.jsxs)(aA,{children:[(0,d.jsxs)(aB,{onSelect:()=>{b.length!==a.length?c(a):c([])},className:"flex items-center space-x-2",children:[(0,d.jsx)(aC.S,{checked:b.length===a.length}),(0,d.jsx)("span",{children:"Select All"})]}),a.map(a=>(0,d.jsxs)(aB,{onSelect:()=>((a,d)=>{d?c([...b,a]):c(b.filter(b=>b!==a))})(a,!b.includes(a)),className:"flex items-center space-x-2",children:[(0,d.jsx)(aC.S,{checked:b.includes(a)}),(0,d.jsx)("span",{children:a})]},a))]})]})]})})]});var aF=c(80665),aG=c(6471),aH=c(79202),aI=c(50526),aJ=c(25054);function aK(){let[a,b]=(0,e.useState)(null),[c,f]=(0,e.useState)([]),[q,D]=(0,e.useState)(!1),[E,F]=(0,e.useState)(!1),[G,H]=(0,e.useState)(""),[I,J]=(0,e.useState)(null),[K,L]=(0,e.useState)(),[M,N]=(0,e.useState)(""),[O,P]=(0,e.useState)("All"),[Q,R]=(0,e.useState)(null),[S,T]=(0,e.useState)(!1),{toast:U}=(0,s.dj)(),{logActivity:V,activities:W}=(0,t.Z)(),{availableProducts:X,getProductByName:Y}=(0,A.G)(),{files:Z}=(0,B.J)(),$=(0,e.useMemo)(()=>{if(!K)return[];let a=(W||[]).filter(a=>("Call Scoring"===a.module&&a.details.scoreOutput||("AI Voice Sales Agent"===a.module||"Browser Voice Agent"===a.module)&&a.details.finalScore)&&(a.product===K||a.details.input?.product===K||a.details.flowInput?.product===K)&&a.details&&"object"==typeof a.details).map(a=>{let b,c,d;return("Call Scoring"===a.module?(b=a.details.scoreOutput,c=a.details.fileName,d="Manual Score"):(b=a.details.finalScore,c=`Voice Call - ${a.details.input?.userName||a.details.flowInput?.userName||"User"}`,d="Voice Agent Score"),b&&"Error"!==b.callCategorisation&&c)?(b.timestamp||(b.timestamp=a.timestamp),{id:a.id,fileName:c,scoreOutput:b,type:d}):null}).filter(a=>null!==a).sort((a,b)=>{let c=a.scoreOutput?.timestamp?new Date(a.scoreOutput.timestamp).getTime():0;return(b.scoreOutput?.timestamp?new Date(b.scoreOutput.timestamp).getTime():0)-c});return"All"===O?a:a.filter(a=>a.type===O)},[K,W,O]);(0,e.useCallback)(()=>{f([])},[K,O]);let _=async()=>{D(!0),J(null),b(null),R(null);let a=$.filter(a=>c.includes(a.id));try{if(a.length<2)throw Error(`At least 2 valid reports are required for a combined analysis. You have selected ${a.length}.`);H(`Found ${a.length} items. Generating combined analysis...`);let c={callReports:a.map(({id:a,type:b,...c})=>c),product:K,overallAnalysisGoal:M},d=await g(c);if(b(d),d.reportTitle.startsWith("Error:")||d.reportTitle.startsWith("Critical Error:"))throw Error(d.batchExecutiveSummary||"The AI returned an error during combined analysis.");U({title:"Combined Analysis Complete!",description:"Aggregated report is ready."}),V({module:"Combined Call Analysis",product:K,details:{input:c,output:d}})}catch(b){let a=b.message||"Unknown error during analysis.";J(`Analysis failed: ${a}`),U({variant:"destructive",title:"Analysis Failed",description:a})}finally{D(!1),H("")}},aa=async b=>{if(!a||!K)return void U({variant:"destructive",title:"Error",description:"A combined report must be generated first."});let c=Y(K);if(!c)return void U({variant:"destructive",title:"Error",description:"Selected product details not found."});F(!0);try{let d=((a,b)=>{if(!a||!Array.isArray(a))return"Knowledge Base not yet loaded.";let c=a.filter(a=>a.product===b.name);if(0===c.length)return"No specific knowledge base content found for this product.";let d=`Knowledge Base Context for Product: ${b.displayName}
---
`;for(let a of c){let b=`(File: ${a.name}, Type: ${a.type}. Content not directly viewed for non-text or large files; AI should use name/type as context.)`;a.isTextEntry&&a.textContent&&(b=a.textContent.substring(0,2e3)+(a.textContent.length>2e3?"...":""));let c=`Item: ${a.name}
Type: ${a.isTextEntry?"Text Entry":"File"}
Category: ${a.category||"General"}
Content Summary/Reference:
${b}
---
`;if(d.length+c.length>15e3){d+="... (Knowledge Base truncated due to length limit for AI context)\n";break}d+=c}return d})(Z,c),e=await h({product:K,cohortsToOptimize:b,analysisReport:a,knowledgeBaseContext:d});if(!e||!e.optimizedPitches||e.optimizedPitches.some(a=>a.pitch.pitchTitle.includes("Error"))){let a=e?.optimizedPitches.find(a=>a.pitch.pitchTitle.includes("Error"));throw Error(a?.pitch.warmIntroduction||"An unexpected error occurred during pitch generation.")}R(e),U({title:"Pitches Generated!",description:`Optimized pitches for ${b.length} cohort(s) are ready.`})}catch(a){U({variant:"destructive",title:"Pitch Generation Failed",description:a.message,duration:8e3}),R(null)}finally{F(!1),T(!0)}};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex flex-col h-full",children:[(0,d.jsx)(u.z,{title:"Combined Call Scoring Analysis"}),(0,d.jsxs)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 flex flex-col items-center space-y-6",children:[(0,d.jsxs)(v.Zp,{className:"w-full max-w-4xl shadow-lg",children:[(0,d.jsxs)(v.aR,{children:[(0,d.jsxs)(v.ZB,{className:"text-xl flex items-center",children:[(0,d.jsx)(l.A,{className:"mr-2 h-6 w-6 text-primary"}),(0,d.jsx)("span",{children:"Configure Analysis"})]}),(0,d.jsx)(v.BT,{children:"Select a product and set an optional goal to begin your combined analysis."})]}),(0,d.jsxs)(v.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)(x.J,{htmlFor:"product-select",className:"font-semibold",children:["Step 1: Select Product Focus ",(0,d.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,d.jsxs)(y.l6,{value:K,onValueChange:a=>{L(a),f([]),b(null)},children:[(0,d.jsx)(y.bq,{id:"product-select",children:(0,d.jsx)(y.yv,{placeholder:"Select a product"})}),(0,d.jsx)(y.gC,{children:X.map(a=>(0,d.jsx)(y.eb,{value:a.name,children:a.displayName},a.name))})]})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(x.J,{htmlFor:"analysis-goal",className:"font-semibold",children:"Step 2: Set Analysis Goal (Optional)"}),(0,d.jsx)(z.T,{id:"analysis-goal",placeholder:"e.g., 'Focus on why pricing objections are leading to lost sales'",rows:1,value:M,onChange:a=>N(a.target.value)})]})]})]}),K&&(0,d.jsxs)(v.Zp,{className:"w-full max-w-4xl",children:[(0,d.jsx)(v.aR,{children:(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(v.ZB,{className:"text-lg font-semibold flex items-center",children:"Step 3: Select Reports for Analysis"}),(0,d.jsx)(v.BT,{children:"Choose at least 2 historical reports to include in the combined analysis."})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(x.J,{htmlFor:"source-filter",className:"text-sm",children:"Source:"}),(0,d.jsxs)(y.l6,{value:O,onValueChange:a=>P(a),children:[(0,d.jsx)(y.bq,{id:"source-filter",className:"w-[200px]",children:(0,d.jsx)(y.yv,{placeholder:"Filter by source"})}),(0,d.jsxs)(y.gC,{children:[(0,d.jsx)(y.eb,{value:"All",children:"All Sources"}),(0,d.jsx)(y.eb,{value:"Manual Score",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Manual Score"]})}),(0,d.jsx)(y.eb,{value:"Voice Agent Score",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(n.A,{className:"w-4 h-4 mr-2"}),"Voice Agent Score"]})})]})]})]})]})}),(0,d.jsx)(v.Wu,{children:(0,d.jsx)(aL,{reports:$,selectedIds:c,onSelectionChange:f})}),(0,d.jsx)(v.wL,{className:"bg-muted/50 border-t px-6 py-4",children:(0,d.jsx)(w.$,{onClick:_,className:"w-full text-base py-6",disabled:q||!K||c.length<2,children:q?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.k,{className:"mr-2"}),G||"Analyzing..."]}):`Run Combined Analysis on ${c.length} Reports`})})]}),I&&!q&&(0,d.jsxs)(k.Fc,{variant:"destructive",className:"mt-4 max-w-lg",children:[(0,d.jsx)(o.A,{className:"h-4 w-4"}),(0,d.jsx)(k.XL,{children:"Analysis Error"}),(0,d.jsx)(C.nD,{type:"single",collapsible:!0,className:"w-full",children:(0,d.jsxs)(C.As,{value:"item-1",className:"border-b-0",children:[(0,d.jsx)(C.$m,{className:"p-0 hover:no-underline text-sm [&_svg]:ml-1",children:"Details"}),(0,d.jsx)(C.ub,{className:"pt-2",children:(0,d.jsx)("pre",{className:"text-xs whitespace-pre-wrap break-all bg-destructive/10 p-2 rounded-md font-mono",children:I})})]})})]}),a&&!q&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(aG.w,{className:"w-full max-w-4xl my-4"}),(0,d.jsx)(i.e,{report:a,individualScores:$.filter(a=>c.includes(a.id))}),(0,d.jsx)(v.Zp,{className:"w-full max-w-5xl",children:(0,d.jsx)(v.wL,{className:"pt-6",children:(0,d.jsxs)("div",{className:"w-full flex flex-col items-center gap-2",children:[(0,d.jsxs)("p",{className:"text-sm font-semibold text-primary flex items-center",children:[(0,d.jsx)(p.A,{className:"w-4 h-4 mr-2 text-accent"}),"Next Step: Turn Insights into Action"]}),(0,d.jsxs)(w.$,{onClick:()=>T(!0),variant:"default",className:"w-full bg-gradient-to-r from-primary to-accent text-primary-foreground",disabled:E,children:[E?(0,d.jsx)(j.k,{size:16,className:"mr-2"}):(0,d.jsx)(r,{className:"mr-2 h-4 w-4"}),E?"Generating Optimized Pitches...":"Generate Optimized Pitches from This Analysis"]})]})})})]})]})]}),a&&(0,d.jsx)(aD,{isOpen:S,onClose:()=>T(!1),product:K,optimizedPitches:Q,onSubmit:aa,isLoading:E})]})}function aL({reports:a,selectedIds:b,onSelectionChange:c}){let e=a.length>0&&b.length===a.length;return(0,d.jsx)(aF.F,{className:"h-72 border rounded-md",children:(0,d.jsxs)(aH.XI,{children:[(0,d.jsx)(aH.A0,{className:"sticky top-0 bg-muted/50",children:(0,d.jsxs)(aH.Hj,{children:[(0,d.jsx)(aH.nd,{className:"w-[50px]",children:(0,d.jsx)(aC.S,{checked:e,onCheckedChange:b=>{c(b?a.map(a=>a.id):[])},"aria-label":"Select all rows"})}),(0,d.jsx)(aH.nd,{children:"Report Name / Source"}),(0,d.jsx)(aH.nd,{children:"Type"}),(0,d.jsx)(aH.nd,{children:"Score"}),(0,d.jsx)(aH.nd,{children:"Date"})]})}),(0,d.jsx)(aH.BF,{children:0===a.length?(0,d.jsx)(aH.Hj,{children:(0,d.jsx)(aH.nA,{colSpan:5,className:"h-24 text-center text-muted-foreground",children:"No historical reports found for this product and source filter."})}):a.map(a=>(0,d.jsxs)(aH.Hj,{"data-state":b.includes(a.id)?"selected":void 0,children:[(0,d.jsx)(aH.nA,{children:(0,d.jsx)(aC.S,{checked:b.includes(a.id),onCheckedChange:d=>{var e;return e=a.id,void(d?c([...b,e]):c(b.filter(a=>a!==e)))},"aria-label":`Select report ${a.fileName}`})}),(0,d.jsx)(aH.nA,{className:"font-medium max-w-xs truncate",title:a.fileName,children:a.fileName}),(0,d.jsx)(aH.nA,{children:(0,d.jsxs)(J.E,{variant:"Manual Score"===a.type?"outline":"secondary",children:["Manual Score"===a.type?(0,d.jsx)(m.A,{className:"w-3 h-3 mr-1.5"}):(0,d.jsx)(n.A,{className:"w-3 h-3 mr-1.5"}),a.type]})}),(0,d.jsx)(aH.nA,{children:(0,d.jsxs)(J.E,{variant:"secondary",className:"font-mono",children:[a.scoreOutput?.overallScore?.toFixed(1)??"N/A"," / 5.0"]})}),(0,d.jsx)(aH.nA,{className:"text-xs text-muted-foreground",children:a.scoreOutput?.timestamp?(0,aI.GP)((0,aJ.H)(a.scoreOutput.timestamp),"PP"):"Invalid Date"})]},a.id))})]})})}},99448:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["(main)",{children:["combined-call-analysis",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,88230)),"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/combined-call-analysis/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,64261)),"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,51472)),"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,I=["/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/combined-call-analysis/page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/(main)/combined-call-analysis/page",pathname:"/combined-call-analysis",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/(main)/combined-call-analysis/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},99599:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(8808).A)("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]])}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[5873,1428,5917,308,7506,8017,4550,5438,62,7786,5039,5938,6191,4455,5477,2178,9533,8881,61,275,1882],()=>b(b.s=99448));module.exports=c})();