(()=>{var a={};a.id=3204,a.ids=[3204],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},643:a=>{"use strict";a.exports=require("node:perf_hooks")},1708:a=>{"use strict";a.exports=require("node:process")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:a=>{"use strict";a.exports=require("node:buffer")},7252:a=>{"use strict";a.exports=require("express")},7666:(a,b,c)=>{Promise.resolve().then(c.bind(c,33743))},8086:a=>{"use strict";a.exports=require("module")},8576:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["(main)",{children:["voice-support-agent",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,49425)),"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/voice-support-agent/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,64261)),"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,51472)),"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,I=["/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/voice-support-agent/page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/(main)/voice-support-agent/page",pathname:"/voice-support-agent",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/(main)/voice-support-agent/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:a=>{"use strict";a.exports=require("assert")},14985:a=>{"use strict";a.exports=require("dns")},16698:a=>{"use strict";a.exports=require("node:async_hooks")},19063:a=>{"use strict";a.exports=require("require-in-the-middle")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19185:a=>{"use strict";a.exports=require("dgram")},19771:a=>{"use strict";a.exports=require("process")},21820:a=>{"use strict";a.exports=require("os")},22858:(a,b,c)=>{"use strict";function d(a,b){if(!b||!b.length)return;let c=Object.keys(b[0]),d=new Blob([c.join(",")+"\n"+b.map(a=>c.map(b=>{let c=null===a[b]||void 0===a[b]?"":a[b];return(c=c instanceof Date?c.toLocaleString():c.toString().replace(/"/g,'""')).search(/("|,|\n)/g)>=0&&(c=`"${c}"`),c}).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),e=document.createElement("a");if(void 0!==e.download){let b=URL.createObjectURL(d);e.setAttribute("href",b),e.setAttribute("download",a),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(b)}}function e(a,b){let c=new Blob([b],{type:a.endsWith(".doc")?"application/msword":"text/plain;charset=utf-8;"}),d=document.createElement("a");if(void 0!==d.download){let b=URL.createObjectURL(c);d.setAttribute("href",b),d.setAttribute("download",a),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(b)}}async function f(a,b){if(!a)return void console.error("No audio reference provided, cannot download.");let c=null;if(a.startsWith("data:")){if(!(c=function(a){if(!a||!a.includes(","))return null;try{let b=atob(a.split(",")[1]),c=a.split(",")[0].split(":")[1].split(";")[0],d=new ArrayBuffer(b.length),e=new Uint8Array(d);for(let a=0;a<b.length;a++)e[a]=b.charCodeAt(a);return new Blob([d],{type:c})}catch(a){return console.error("Error converting data URI to Blob:",a),null}}(a)))return void console.error("Failed to convert Data URI to Blob for download.")}else try{let b=await fetch(a);if(!b.ok)throw Error(`Failed to fetch audio asset (${b.status})`);c=await b.blob()}catch(a){console.error("Unable to download remote audio asset:",a);return}let d=document.createElement("a");if(void 0!==d.download&&c){let a=URL.createObjectURL(c);d.setAttribute("href",a),d.setAttribute("download",b),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(a)}}function g(a,b,c){let d=function(a,b,c){let d="",e=a.map((a,c)=>{let d=a.length;return b.forEach(a=>{let b=String(null===a[c]||void 0===a[c]?"":a[c]);b.length>d&&(d=b.length)}),d}),f=a.map((a,b)=>a.padEnd(e[b])).join(" | ");return d+=f+"\n"+a.map((a,b)=>"-".repeat(e[b])).join("-+-")+"\n",b.forEach(a=>{let b=a.map((a,b)=>String(null==a?"":a).padEnd(e[b])).join(" | ");d+=b+"\n"}),d}(b,c);e(a.endsWith(".doc")?a:`${a}.doc`,d)}async function h(a,b,d){let{jsPDF:e}=await c.e(5039).then(c.bind(c,75039)),{default:f}=await c.e(7439).then(c.bind(c,57439)),g=new e({orientation:"landscape"});f(g,{head:[b],body:d,styles:{fontSize:8},headStyles:{fillColor:[41,128,185]},margin:{top:20},didDrawPage:function(a){g.setFontSize(16),g.text("Exported Table Data",a.settings.margin.left,15)}}),g.save(a.endsWith(".pdf")?a:`${a}.pdf`)}c.d(b,{U3:()=>e,e3:()=>h,mf:()=>g,vG:()=>f,yR:()=>d})},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33743:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>_});var d=c(21124),e=c(38301),f=c(89266),g=c(35284),h=c(62186),i=c(45608),j=c(93758),k=c(68120),l=c(64772),m=c(80665),n=c(45019),o=c(93302),p=c(68254),q=c(37448),r=c(90629),s=c(44183),t=c(76530),u=c(7952),v=c(40735),w=c(55199),x=c(85708);let y=(0,x.createServerReference)("40f1d91439c67c38fca07d4a12627e2e11bf93ba9b",x.callServer,void 0,x.findSourceMapURL,"runVoiceSupportAgentQuery");var z=c(57004),A=c(98590),B=c(99388),C=c(68334),D=c(49113),E=c(54039),F=c(92080),G=c(8808);let H=(0,G.A)("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);var I=c(51886),J=c(67362);let K=(0,G.A)("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);var L=c(66533),M=c(38692),N=c(59487),O=c(74470),P=c(6375),Q=c(64727);let R=(0,G.A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var S=c(89308),T=c(99187),U=c(22858),V=c(23727),W=c(50526),X=c(25054),Y=c(6471);let Z=(a,b,c)=>{let d=`--- START OF KNOWLEDGE BASE CONTEXT FOR PRODUCT: ${b.displayName} ---
`;d+=`Description: ${b.description||"Not provided"}
`;let e=a.filter(a=>a.product===b.name),f=(a,b)=>{b.length>0&&(d+=`--- ${a.toUpperCase()} ---
`,b.forEach(a=>{let b=`
--- Item: ${a.name} ---
`;a.isTextEntry&&a.textContent?b+=`Content:
${a.textContent}
`:b+=`(This is a reference to a ${a.type} file named '${a.name}'. The AI should infer context from its name, type, and category.)
`,d.length+b.length<=3e4&&(d+=b)}),d+=`--- END ${a.toUpperCase()} ---

`)},g=e.filter(a=>"Pitch"===a.category),h=e.filter(a=>"Product Description"===a.category),i=e.filter(a=>"Pricing"===a.category),j=e.filter(a=>"Rebuttals"===a.category),k=e.filter(a=>!a.category||!["Pitch","Product Description","Pricing","Rebuttals"].includes(a.category));return f("PRODUCT DETAILS, FEATURES, & PRICING (Source for factual information)",[...h,...i]),f("COMMON OBJECTIONS & REBUTTALS (Source for handling objections)",j),f("PITCH & SALES FLOW CONTEXT",g),f("GENERAL SUPPLEMENTARY CONTEXT",k),0===e.length&&(d+="No specific files or text entries were found for this product in the Knowledge Base.\n"),d.length>=3e4&&console.warn("Knowledge base context truncated due to length limit."),(d+="--- END OF KNOWLEDGE BASE CONTEXT ---").substring(0,3e4)},$=a=>"AI"===a?"AGENT":"USER";function _(){let[a,b]=(0,e.useState)("CONFIGURING"),c=(0,e.useRef)(a),[x,G]=(0,e.useState)(null),R=(0,e.useRef)(null),_=(0,e.useRef)(null);(0,e.useRef)([]);let[ab,ac]=(0,e.useState)(null),[ad,ae]=(0,e.useState)(-1),[af,ag]=(0,e.useState)(!1),{toast:ah}=(0,q.dj)(),{activities:ai,logActivity:aj,updateActivity:ak}=(0,r.Z)(),{files:al}=(0,s.J)(),{availableProducts:am,getProductByName:an}=(0,u.G)(),ao=(0,e.useRef)(null),ap=(0,e.useRef)(null),[aq,ar]=(0,e.useState)(v.U[0].id),as="CONFIGURING"!==a&&"IDLE"!==a&&"ENDED"!==a,[at,au]=(0,e.useState)(!1),[av,aw]=(0,e.useState)("ET"),[ax,ay]=(0,e.useState)(""),[az,aA]=(0,e.useState)(""),[aB,aC]=(0,e.useState)([]),[aD,aE]=(0,e.useState)(null),[aF,aG]=(0,e.useState)(""),[aH,aI]=(0,e.useState)(null),[aJ,aK]=(0,e.useState)(!1),aL=(0,e.useRef)(null),aM=((0,e.useRef)(null),(0,e.useRef)(null),(0,e.useRef)(null)),aN=(0,e.useRef)([]),aO=((0,e.useRef)(Date.now()),(0,e.useRef)(null),(0,e.useRef)(null),(0,e.useRef)(null),(0,e.useCallback)(async()=>{},[!1])),aP=(0,e.useCallback)(async()=>null,[!1]),aQ=(0,e.useCallback)(a=>new Promise((b,c)=>{let d=new FileReader;d.onloadend=()=>{"string"==typeof d.result?b(d.result):c(Error("Failed to read audio recording."))},d.onerror=()=>c(d.error??Error("Failed to read audio recording.")),d.readAsDataURL(a)}),[]),aR=(0,e.useCallback)(()=>aN.current.length>0?new Blob(aN.current,{type:aM.current?.mimeType||"audio/webm"}):null,[]),aS=((0,e.useCallback)(async()=>{let a=aR();if(a)try{let b=await aQ(a);G(b)}catch(a){console.warn("Failed to update current recording:",a)}},[aR,aQ]),(0,e.useCallback)(()=>{_.current&&(_.current.pause(),_.current.removeAttribute("src"),_.current.currentTime=0),ac(null),ae(-1),"AI_SPEAKING"===c.current&&b("LISTENING")},[])),aT=(0,e.useRef)(null),aU=(0,e.useCallback)((a,b)=>{let c=a.play();c&&"function"==typeof c.catch&&c.catch(a=>{a?.name==="AbortError"||a?.message?.includes("The play() request was interrupted")||b(a)})},[]),aV=(0,e.useCallback)((a,c)=>{_.current&&(_.current.pause(),_.current.src=a,_.current.currentTime=0,ac(c),b("AI_SPEAKING"),aU(_.current,a=>{console.error("Audio playback error:",a),b("LISTENING")}))},[aU]),{isRecording:aW,startRecording:aX,stopRecording:aY}=(0,t.C)({onTranscriptionComplete:a=>{aT.current&&aT.current(a)},onTranscribe:a=>{"AI_SPEAKING"===c.current&&a.trim().length>0&&aS(),aG(a)},inactivityTimeout:9e3,silenceTimeout:30}),aZ=(0,e.useCallback)(async(a,c)=>{let d=performance.now();if(console.log(`VoiceSupport: Starting support query processing for turn ${c.length+1}`),!av||!ax.trim()){ah({variant:"destructive",title:"Missing Info",description:"Please select a Product and enter an Agent Name."}),b("CONFIGURING");return}b("PROCESSING"),aE(null);let e=an(av);if(!e){ah({variant:"destructive",title:"Error",description:"Selected product details not found."}),b("CONFIGURING");return}let f=(()=>{let a=aL.current,b=al.map(a=>`${a.id}-${a.name}-${a.product}-${a.category}`).join("|");if(a&&a.filesHash===b&&a.productName===e.name)return console.log(`VoiceSupport: Using cached KB context (${a.context.length} chars)`),a.context;let d=Z(al,e,c);return aL.current={filesHash:b,productName:e.name,context:d},console.log(`VoiceSupport: Generated new KB context (${d.length} chars)`),d})();f.startsWith("No specific knowledge base content found")&&ah({variant:"default",title:"Limited KB",description:`Knowledge Base for ${av} is sparse. Answers may be general.`,duration:5e3});let g={product:av,agentName:ax,userName:az,userQuery:a,knowledgeBaseContext:f,conversationHistory:c},h=async(a,c)=>{try{let d=a.replace(/\bET\b/g,"E T"),e=await (0,w.T)({text:d,voice:aq});aC(a=>a.map(a=>a.id===c?{...a,audioDataUri:e.audioDataUri}:a)),_.current&&(_.current.pause(),_.current.src=e.audioDataUri,_.current.currentTime=0,ac(c),b("AI_SPEAKING"),aU(_.current,a=>{console.error("Audio playback error:",a),b("LISTENING")}))}catch(a){ah({variant:"destructive",title:"TTS Error",description:a.message}),b("LISTENING")}};try{let a=performance.now(),e=await y(g),f=performance.now();if(console.log(`VoiceSupport: AI flow completed in ${(f-a).toFixed(2)}ms`),e.errorMessage)throw Error(e.errorMessage);let i={id:`ai-${Date.now()}`,speaker:"AI",text:e.aiResponseText||"(No response generated)",timestamp:new Date().toISOString()},j=[...c,i];aC(j),e.aiResponseText?await h(e.aiResponseText,i.id):b("LISTENING");let k={flowInput:g,flowOutput:e,fullTranscriptText:j.map(a=>`${$(a.speaker)}: ${a.text}`).join("\n"),fullConversation:j,error:e.errorMessage};ap.current?ak(ap.current,k):ap.current=aj({module:"AI Voice Support Agent",product:av,details:k});let l=performance.now();console.log(`VoiceSupport: Complete turn ${c.length+1} processed in ${(l-d).toFixed(2)}ms`)}catch(d){let a=d.message||"An unexpected error occurred.";aE(a),b("ERROR");let c={id:`error-${Date.now()}`,speaker:"AI",text:a,timestamp:new Date().toISOString()};aC(a=>[...a,c])}},[av,ax,az,an,al,aj,ak,ah,aq,aU]);aT.current=a=>{if("LISTENING"!==c.current&&"AI_SPEAKING"!==c.current)return;let b=a.trim();if(aG(""),!b)return void aZ("",aB);let d=[...aB,{id:`user-${Date.now()}`,speaker:"User",text:b,timestamp:new Date().toISOString()}];aC(d),aZ(b,d)};let a$=(0,e.useCallback)(async(a="Completed")=>{let d;if("ENDED"===c.current)return;aY(),aS(),b("PROCESSING");let e=[...aB];try{let a=await aP();a&&a.size>0&&(d=await aQ(a))}catch(a){console.warn("VoiceSupport: failed to capture live recording, falling back to synthesis",a)}if(!d)try{let a=await (0,A.R)({conversationHistory:e,agentVoiceProfile:aq});a.audioDataUri?d=a.audioDataUri:a.errorMessage&&ah({variant:"destructive",title:"Audio Generation Failed",description:a.errorMessage})}catch(a){ah({variant:"destructive",title:"Audio Generation Error",description:a.message})}b("ENDED");let f=e.map(a=>{let b="AI"===a.speaker?"AGENT":"USER";return`[${(0,W.GP)((0,X.H)(a.timestamp),"HH:mm:ss")}] ${b}: ${a.text}`}).join("\n\n");if(aI({transcript:f,audioUri:d}),ap.current){let b=ai.find(a=>a.id===ap.current);b&&ak(ap.current,{...b.details,status:a,fullTranscriptText:f,fullConversation:e,fullCallAudioDataUri:d})}},[aB,ak,ah,aq,aY,aS,ai,aP,aQ,A.R]),a_=(0,e.useCallback)(async()=>{au(!0);try{let a=await (0,w.T)({text:v.R,voice:aq}),b=new Audio(a.audioDataUri),c=b.play();c&&"function"==typeof c.catch&&c.catch(a=>{a?.name==="AbortError"||a?.message?.includes("The play() request was interrupted")||(console.error("Audio preview playback error:",a),ah({variant:"destructive",title:"Audio Playback Error",description:"Could not play the generated voice sample."}),au(!1))}),b.onended=()=>au(!1),b.onerror=a=>{console.error("Audio preview playback error:",a),ah({variant:"destructive",title:"Audio Playback Error",description:"Could not play the generated voice sample."}),au(!1)}}catch(a){ah({variant:"destructive",title:"TTS Error",description:a.message}),au(!1)}},[aq,ah]),a0=async()=>{if(!av||!ax.trim())return void ah({variant:"destructive",title:"Missing Info",description:"Please select a Product and enter an Agent Name."});try{await aO()}catch(a){console.warn("VoiceSupport: Failed to set up recording graph, continuing without full audio recording",a)}let a=`Hello ${az||"there"}, this is ${ax}. How can I help you today regarding ${am.find(a=>a.name===av)?.displayName||av}?`,c={id:`ai-${Date.now()}`,speaker:"AI",text:a,timestamp:new Date().toISOString()};aC([c]),b("PROCESSING"),ap.current=aj({module:"AI Voice Support Agent",product:av,details:{flowInput:{product:av,agentName:ax,userName:az,userQuery:"(Initiated Call)",knowledgeBaseContext:""},status:"In Progress"}});try{let d=await (0,w.T)({text:a,voice:aq});aC(a=>a.map(a=>a.id===c.id?{...a,audioDataUri:d.audioDataUri}:a)),_.current&&(_.current.pause(),_.current.src=d.audioDataUri,_.current.currentTime=0,ac(c.id),b("AI_SPEAKING"),aU(_.current,a=>{console.error("Audio playback error:",a),b("LISTENING")}))}catch(a){ah({variant:"destructive",title:"TTS Error on Welcome",description:a.message}),b("LISTENING")}},a1=async()=>{if(!aH||!aH.transcript||!av)return void ah({variant:"destructive",title:"Error",description:"No final transcript or product context available to score."});aK(!0);try{let a=am.find(a=>a.name===av),b=a?Z(al,a,[]):"No product context available.",c=await (0,z.t)({product:av,agentName:ax,transcriptOverride:aH.transcript,productContext:b});if(aI(a=>a?{...a,score:c}:null),ap.current){let a=ai.find(a=>a.id===ap.current);a&&ak(ap.current,{...a.details,finalScore:c})}ah({title:"Scoring Complete!",description:"The interaction has been scored successfully."})}catch(a){ah({variant:"destructive",title:"Scoring Failed",description:a.message})}finally{aK(!1)}};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("audio",{ref:_,className:"hidden"}),(0,d.jsxs)("div",{className:"flex flex-col h-full",children:[(0,d.jsx)(f.z,{title:"AI Voice Support Agent"}),(0,d.jsxs)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-6",children:[(0,d.jsxs)(h.Zp,{className:"w-full max-w-3xl mx-auto",children:[(0,d.jsxs)(h.aR,{children:[(0,d.jsxs)(h.ZB,{className:"text-xl flex items-center",children:[(0,d.jsx)(H,{className:"mr-2 h-6 w-6 text-primary"})," AI Customer Support Configuration"]}),(0,d.jsx)(h.BT,{children:"Set up agent and customer context, product, and voice profile. The AI will automatically use the most relevant Knowledge Base content for its answers."})]}),(0,d.jsxs)(h.Wu,{className:"space-y-4",children:[(0,d.jsx)(S.nD,{type:"single",collapsible:!0,defaultValue:"CONFIGURING"===a?"item-config":"",className:"w-full",children:(0,d.jsxs)(S.As,{value:"item-config",children:[(0,d.jsx)(S.$m,{className:"text-md font-semibold hover:no-underline py-2 text-foreground/90 [&[data-state=open]>&svg]:rotate-180",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(I.A,{className:"mr-2 h-4 w-4 text-accent"}),"Context Configuration"]})}),(0,d.jsxs)(S.ub,{className:"pt-3 space-y-4",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)(k.J,{children:["AI Voice Profile ",(0,d.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,d.jsx)("div",{className:"mt-2",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)(i.l6,{value:aq,onValueChange:ar,disabled:as,children:[(0,d.jsx)(i.bq,{className:"flex-grow",children:(0,d.jsx)(i.yv,{placeholder:"Loading voices..."})}),(0,d.jsx)(i.gC,{children:v.U.map(a=>(0,d.jsx)(i.eb,{value:a.id,children:a.name},a.id))})]}),(0,d.jsx)(g.$,{variant:"outline",size:"sm",onClick:a_,disabled:at||as,children:at?(0,d.jsx)(D.A,{className:"h-4 w-4 animate-spin"}):(0,d.jsx)(J.A,{className:"h-4 w-4"})})]})})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)(k.J,{htmlFor:"product-select-support",children:["Product ",(0,d.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,d.jsxs)(i.l6,{value:av,onValueChange:a=>aw(a),disabled:as,children:[(0,d.jsx)(i.bq,{id:"product-select-support",children:(0,d.jsx)(i.yv,{placeholder:"Select a Product"})}),(0,d.jsx)(i.gC,{children:am.map(a=>(0,d.jsx)(i.eb,{value:a.name,children:a.displayName},a.name))})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)(k.J,{htmlFor:"support-agent-name",children:["Agent Name ",(0,d.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,d.jsx)(j.p,{id:"support-agent-name",placeholder:"e.g., SupportBot (AI)",value:ax,onChange:a=>ay(a.target.value),disabled:as})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)(k.J,{htmlFor:"support-user-name",children:"Customer Name (Optional)"}),(0,d.jsx)(j.p,{id:"support-user-name",placeholder:"e.g., Priya Sharma",value:az,onChange:a=>aA(a.target.value),disabled:as})]})]})]})]})}),"CONFIGURING"===a&&(0,d.jsxs)(g.$,{onClick:a0,disabled:"CONFIGURING"!==a||!av||!ax.trim(),className:"w-full mt-4",children:[(0,d.jsx)(K,{className:"mr-2 h-4 w-4"})," Start Interaction"]})]})]}),as&&(0,d.jsxs)(h.Zp,{className:"w-full max-w-3xl mx-auto mt-4",children:[(0,d.jsxs)(h.aR,{children:[(0,d.jsxs)(h.ZB,{className:"text-lg flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(L.A,{className:"mr-2 h-5 w-5 text-primary"})," Ask a Question / Log Interaction"]}),(()=>{switch(a){case"LISTENING":return(0,d.jsxs)(T.E,{variant:"default",className:"text-xs bg-green-100 text-green-800",children:[(0,d.jsx)(B.A,{className:"mr-1.5 h-3.5 w-3.5"}),"Listening..."]});case"AI_SPEAKING":return(0,d.jsxs)(T.E,{variant:"outline",className:"text-xs bg-amber-100 text-amber-800",children:[(0,d.jsx)(C.A,{className:"mr-1.5 h-3.5 w-3.5"}),"AI Speaking (Interruptible)"]});case"PROCESSING":return(0,d.jsxs)(T.E,{variant:"secondary",className:"text-xs",children:[(0,d.jsx)(D.A,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}),"Processing..."]});case"ENDED":return(0,d.jsxs)(T.E,{variant:"secondary",className:"text-xs bg-gray-200 text-gray-600",children:[(0,d.jsx)(E.A,{className:"mr-1.5 h-3.5 w-3.5"}),"Ended"]});case"ERROR":return(0,d.jsxs)(T.E,{variant:"destructive",className:"text-xs",children:[(0,d.jsx)(F.A,{className:"mr-1.5 h-3.5 w-3.5"}),"Error"]});default:return(0,d.jsx)(T.E,{variant:"outline",className:"text-xs",children:"Idle"})}})()]}),(0,d.jsxs)(h.BT,{children:["Type your question below and hit send, or just start speaking. The AI will respond based on its Knowledge Base for product '",av,"'."]})]}),(0,d.jsxs)(h.Wu,{children:[(0,d.jsxs)(m.F,{className:"h-[300px] w-full border rounded-md p-3 bg-muted/10 mb-3",children:[aB.map(a=>(0,d.jsx)(o.j,{turn:a,onPlayAudio:aV,currentlyPlayingId:ab,wordIndex:a.id===ab?ad:-1},a.id)),"LISTENING"===a&&(0,d.jsxs)("div",{className:"flex items-start gap-2.5 my-3 justify-end user-line",children:[(0,d.jsx)("div",{className:"flex flex-col gap-1 w-full max-w-[80%] items-end",children:(0,d.jsx)(h.Zp,{className:"max-w-full w-fit p-3 rounded-xl shadow-sm bg-accent/80 text-accent-foreground rounded-br-none",children:(0,d.jsx)(h.Wu,{className:"p-0 text-sm",children:(0,d.jsx)("p",{className:"italic",children:aF||" Listening..."})})})}),(0,d.jsx)(V.eu,{className:"h-8 w-8 shrink-0",children:(0,d.jsx)(V.q5,{className:"bg-accent text-accent-foreground",children:(0,d.jsx)(M.A,{size:18})})})]}),"PROCESSING"===a&&(0,d.jsx)(n.k,{size:16,className:"mx-auto my-2"}),(0,d.jsx)("div",{ref:ao})]}),x&&(0,d.jsxs)("div",{className:"mb-3 p-3 border rounded-md bg-muted/10",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,d.jsx)(B.A,{className:"h-4 w-4 text-primary"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"Live Call Recording"})]}),(0,d.jsx)("audio",{ref:R,controls:!0,className:"w-full",src:x}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Full call recording - you can seek, rewind, and fast-forward"})]}),aD&&(0,d.jsx)(l.Fc,{variant:"destructive",className:"mb-3",children:(0,d.jsx)(S.nD,{type:"single",collapsible:!0,children:(0,d.jsxs)(S.As,{value:"item-1",className:"border-b-0",children:[(0,d.jsx)(S.$m,{className:"p-0 hover:no-underline text-sm font-semibold [&_svg]:ml-1",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(F.A,{className:"h-4 w-4 mr-2"})," An error occurred. Click to see details."]})}),(0,d.jsx)(S.ub,{className:"pt-2 text-xs",children:(0,d.jsx)("pre",{className:"whitespace-pre-wrap break-all bg-destructive/10 p-2 rounded-md font-mono",children:aD})})]})})}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground mb-2",children:"Optional: Type a response instead of speaking."}),(0,d.jsx)(aa,{onSubmit:a=>{let b=[...aB,{id:`user-${Date.now()}`,speaker:"User",text:a,timestamp:new Date().toISOString()}];aC(b),aG(""),aZ(a,b)},disabled:"LISTENING"!==a&&"AI_SPEAKING"!==a})]}),(0,d.jsxs)(h.wL,{className:"flex justify-between items-center pt-4",children:[(0,d.jsxs)(g.$,{onClick:()=>a$(),variant:"destructive",size:"sm",disabled:"PROCESSING"===a,children:[(0,d.jsx)(E.A,{className:"mr-2 h-4 w-4"})," End Interaction"]}),(0,d.jsxs)(g.$,{onClick:()=>{if(ap.current&&"CONFIGURING"!==c.current){let a=ai.find(a=>a.id===ap.current);a&&ak(ap.current,{...a.details,status:"Completed (Reset)",fullTranscriptText:aB.map(a=>`${$(a.speaker)}: ${a.text}`).join("\n"),fullConversation:aB}),ah({title:"Interaction Logged",description:"The previous session was logged before resetting."})}b("CONFIGURING"),ap.current=null,aC([]),aE(null),aI(null),aG(""),aK(!1),aS()},variant:"outline",size:"sm",children:[(0,d.jsx)(N.A,{className:"mr-2 h-4 w-4"})," New Interaction"]})]})]}),aH&&"ENDED"===a&&(0,d.jsxs)(h.Zp,{className:"w-full max-w-4xl mx-auto mt-4",children:[(0,d.jsxs)(h.aR,{children:[(0,d.jsx)(h.ZB,{children:"Interaction Review & Scoring"}),(0,d.jsx)(h.BT,{children:"Review the completed interaction transcript and score it."})]}),(0,d.jsxs)(h.Wu,{className:"space-y-4",children:[aH.audioUri&&(0,d.jsxs)("div",{children:[(0,d.jsx)(k.J,{htmlFor:"final-audio-support",children:"Full Interaction Recording"}),(0,d.jsx)("audio",{id:"final-audio-support",controls:!0,src:aH.audioUri,className:"w-full mt-1 h-10",children:"Your browser does not support the audio element."}),(0,d.jsx)("div",{className:"mt-2 flex gap-2",children:(0,d.jsxs)(g.$,{variant:"outline",size:"xs",onClick:()=>(0,U.vG)(aH.audioUri,`SupportInteraction_${az||"User"}.wav`),children:[(0,d.jsx)(O.A,{className:"mr-1 h-3"}),"Download Recording"]})})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(k.J,{htmlFor:"final-transcript-support",children:"Full Transcript"}),(0,d.jsx)(p.T,{id:"final-transcript-support",value:aH.transcript,readOnly:!0,className:"h-40 text-xs bg-muted/50 mt-1"}),(0,d.jsx)("div",{className:"mt-2 flex gap-2",children:(0,d.jsxs)(g.$,{variant:"outline",size:"xs",onClick:()=>(0,U.U3)(`SupportInteraction_${az||"User"}_transcript.txt`,aH.transcript),children:[(0,d.jsx)(P.A,{className:"mr-1 h-3"}),"Download .txt"]})})]}),(0,d.jsx)(Y.w,{}),aH.score?(0,d.jsxs)(l.Fc,{variant:"default",className:"bg-green-50 border-green-200",children:[(0,d.jsx)(l.XL,{className:"text-green-800",children:"Interaction Scored!"}),(0,d.jsxs)(l.TN,{className:"text-green-700",children:["Overall Score: ",aH.score.overallScore.toFixed(1),"/5 (",aH.score.callCategorisation,"). View details in the Call Scoring Dashboard."]})]}):(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"text-md font-semibold",children:"Score this Interaction"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Run AI analysis on the final transcript."}),(0,d.jsxs)(g.$,{onClick:a1,disabled:aJ||!aH.transcript,children:[aJ?(0,d.jsx)(D.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,d.jsx)(Q.A,{className:"mr-2 h-4 w-4"}),aJ?"Scoring...":"Run AI Scoring"]})]})]})]})]})]})]})}function aa({onSubmit:a,disabled:b}){let[c,f]=(0,e.useState)("");return(0,d.jsxs)("form",{onSubmit:b=>{b.preventDefault(),c.trim()&&(a(c),f(""))},className:"flex items-center gap-2",children:[(0,d.jsx)(j.p,{value:c,onChange:a=>f(a.target.value),placeholder:"Type your question here...",disabled:b,autoComplete:"off"}),(0,d.jsx)(g.$,{type:"submit",disabled:b||!c.trim(),children:(0,d.jsx)(R,{className:"h-4 w-4"})})]})}},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},37067:a=>{"use strict";a.exports=require("node:http")},37830:a=>{"use strict";a.exports=require("node:stream/web")},38522:a=>{"use strict";a.exports=require("node:zlib")},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},44618:(a,b,c)=>{Promise.resolve().then(c.bind(c,49425))},44708:a=>{"use strict";a.exports=require("node:https")},49425:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/voice-support-agent/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Anchit.Tandon/Desktop/AI HUSTLE - APPS/AI-Telesuite-FireBase/src/app/(main)/voice-support-agent/page.tsx","default")},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},56801:a=>{"use strict";a.exports=require("import-in-the-middle")},56963:(a,b,c)=>{"use strict";c.r(b),c.d(b,{"40592173cbe840837a40a5f15804c0744f59f71582":()=>l.t,"408ed81c3074e7991d01da4d5606a81d4f65f7dac4":()=>m.R,"40f1d91439c67c38fca07d4a12627e2e11bf93ba9b":()=>k});var d=c(91488);c(27806);var e=c(38710),f=c(56571),g=c(87603),h=c(40410);let i=e.ai.definePrompt({name:"generateSupportResponsePrompt",input:{schema:g.Ur},output:{schema:g.Bl},prompt:`You are a clear, factual, step-by-step support agent for {{{product}}}. Your name is {{{agentName}}}.
Your primary goal is to provide crisp, factual support answers grounded in the provided Knowledge Base.
If the user's name is known, start by addressing them politely (e.g., "Hello {{{userName}}}, regarding your query about...").

**CRITICAL DIRECTIVE: You MUST base your entire response *exclusively* on the information provided in the structured 'Knowledge Base Context' section below. If the provided Knowledge Base is insufficient, you are authorized to supplement your response by browsing the official product website ({{{brandUrl}}}) and its sub-pages to find accurate information. Your primary goal is to be truthful to the knowledge base and helpful.**

**KNOWLEDGE BASE USAGE RULES (NON-NEGOTIABLE):**
1.  For any factual content about the product, including features, troubleshooting steps, and policies, you MUST exclusively use content from the Knowledge Base.
2.  If a category of document is missing or the KB does not contain an answer, you must state that and suggest escalation.
3.  Never invent information. If the KB doesn't provide a detail, do not mention it.

User's Query: "{{{userQuery}}}"
Conversation History so far: {{{conversationHistory}}}

Knowledge Base Context for {{{product}}} (Your ONLY Source of Truth):
\`\`\`
{{{knowledgeBaseContext}}}
\`\`\`

**Critical Instructions for Response Generation:**

1.  **Analyze User Query & History:** Carefully understand the intent behind "{{{userQuery}}}" in the context of the conversation history. Is it a new question, a follow-up, or a clarification?

2.  **Prioritize Knowledge Base (KB):**
    *   **Direct Answer:** If the 'Knowledge Base Context' **directly and clearly** provides the information to answer the user's query, formulate a comprehensive and natural response using this information.
    *   **Indirect Answer:** If the KB provides related information but not a direct answer, share the relevant KB information and politely explain how it might help, or use it to ask a clarifying question.
    
3.  **Handling Queries Requiring Live/Personal Account Data:**
    *   If the query asks for information **specific to the user's personal account and NOT typically found in a static Knowledge Base** (e.g., "When is MY plan expiring?", "Where is MY invoice?", "Can you reset MY password?"):
        *   Politely state that for such specific account information, they would need to speak with a human agent who can securely access their account.
        *   Set **requiresLiveDataFetch** to **true**.
        *   **CRITICAL: DO NOT invent or guess any specific user data, dates, or personal details.**
        *   If the KB provides *general guidance* (e.g., "Invoices are in your account section on our website"), provide this.
        *   Example: "For specific details like your plan's expiry date, I'll need to connect you with one of our human agents who can securely access your account details. Would you like me to do that?"
        
4.  **Handling Queries Not in Knowledge Base (and not personal data):**
    *   If the Knowledge Base does **not** contain information to answer a general query:
        *   Politely state that you couldn't find specific information on that exact query in your available resources.
        *   Set **isUnanswerableFromKB** to **true**.
        *   Offer to connect them to a human agent for more specialized help.
        *   Example: "I've checked our resources for {{{product}}}, but I couldn't find specific details on your query about [topic]. I can connect you with a team member who might have more information. Would you like that?"

5.  **Response Style:**
    *   **Be Conversational:** Don't just state facts. Weave them into a helpful, polite, and natural conversation.
    *   **Be Comprehensive:** If a question requires a detailed explanation, provide one. Use bullet points for clarity if explaining steps.
    *   **Professional Tone:** Maintain a helpful, empathetic, and professional tone throughout.
    *   **Forbidden Phrases:** Never use phrases like "should I use the knowledge base", "do you want me to check the KB", or "I cannot access the KB unless you allow". Access is automatic.

Based *strictly* on the user's query, history, and the provided Knowledge Base Context, generate the responseText.
The responseText should be ready to be "spoken" to the user.
`,model:f.e.MULTIMODAL_PRIMARY,config:{temperature:.3}}),j=e.ai.defineFlow({name:"runVoiceSupportAgentQuery",inputSchema:g.Ur,outputSchema:g.Bl},async a=>{let b="",c=!1,d=[];try{a.knowledgeBaseContext.startsWith("No specific knowledge base content found")&&(d.push("Limited Knowledge Base"),console.warn("VoiceSupportAgentFlow: KB context is limited or missing for product:",a.product));let{output:e}=await i(a);if(!e||!e.responseText)throw Error("AI failed to generate a support response text. The response from the model was empty or invalid.");return b=e.responseText,(e.requiresLiveDataFetch||e.isUnanswerableFromKB)&&(b.toLowerCase().includes("human")||b.toLowerCase().includes("team member")||b.toLowerCase().includes("connect you")||(b+=`

Would you like me to connect you with a team member for further assistance with this?`),c=!0),{aiResponseText:b,escalationSuggested:c,sourcesUsed:d.length>0?[...new Set(d)]:void 0}}catch(c){console.error("Error in VoiceSupportAgentFlow:",JSON.stringify(c,Object.getOwnPropertyNames(c),2));let b=c.message||"An unexpected error occurred in the support agent flow.";return{aiResponseText:`I'm sorry, ${a.userName||"there"}, I encountered an issue trying to process your request: "${(c.message||"Internal Error").substring(0,100)}...". Please try again later, or I can try to connect you with a human agent.`,escalationSuggested:!0,errorMessage:b}}});async function k(a){return j(a)}(0,h.D)([k]),(0,d.A)(k,"40f1d91439c67c38fca07d4a12627e2e11bf93ba9b",null);var l=c(20102),m=c(10685)},57004:(a,b,c)=>{"use strict";c.d(b,{t:()=>e});var d=c(85708);let e=(0,d.createServerReference)("40592173cbe840837a40a5f15804c0744f59f71582",d.callServer,void 0,d.findSourceMapURL,"scoreCall")},57075:a=>{"use strict";a.exports=require("node:stream")},57265:a=>{"use strict";a.exports=require("child_process")},57975:a=>{"use strict";a.exports=require("node:util")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64727:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(8808).A)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},68254:(a,b,c)=>{"use strict";c.d(b,{T:()=>g});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("textarea",{className:(0,f.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:c,...b}));g.displayName="Textarea"},73024:a=>{"use strict";a.exports=require("node:fs")},73136:a=>{"use strict";a.exports=require("node:url")},73496:a=>{"use strict";a.exports=require("http2")},73566:a=>{"use strict";a.exports=require("worker_threads")},74075:a=>{"use strict";a.exports=require("zlib")},74470:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(8808).A)("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]])},74998:a=>{"use strict";a.exports=require("perf_hooks")},76760:a=>{"use strict";a.exports=require("node:path")},77030:a=>{"use strict";a.exports=require("node:net")},77598:a=>{"use strict";a.exports=require("node:crypto")},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},79748:a=>{"use strict";a.exports=require("fs/promises")},81630:a=>{"use strict";a.exports=require("http")},84297:a=>{"use strict";a.exports=require("async_hooks")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},91645:a=>{"use strict";a.exports=require("net")},94735:a=>{"use strict";a.exports=require("events")}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[5873,1428,5917,308,7506,8017,4550,5438,62,7786,5938,5477,2178,9533,102,6903],()=>b(b.s=8576));module.exports=c})();