(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4715],{33733:(e,t,n)=>{Promise.resolve().then(n.bind(n,58584))},58584:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>E});var r=n(95155),i=n(12115),o=n(74111),l=n(97403),s=n(40355),a=n(65363),c=n(18332),d=n(7545),u=n(84336),h=n(15894),p=n(79313),m=n(36950),f=n(39437),x=n(86948),g=n(13496),N=n(31524);function E(){let[e,t]=(0,i.useState)(null),[n,E]=(0,i.useState)(!1),[T,C]=(0,i.useState)(null),{toast:w}=(0,h.dj)(),{logActivity:P}=(0,p.Z)(),{files:j}=(0,f.J)(),{getProductByName:y}=(0,N.G)(),b=async(e,n,r)=>{let i,l;E(!0),C(null),t(null);let s=e.product;if(!s){w({variant:"destructive",title:"Error",description:"Product must be selected."}),E(!1);return}let a=y(s);if(!a){w({variant:"destructive",title:"Error",description:"Selected product details not found."}),E(!1);return}let c=!1,d=((e,t,n)=>{if(!t||!Array.isArray(e))return"No product or knowledge base provided.";let r=e.filter(e=>e.product===t.name),i="--- START OF KNOWLEDGE BASE CONTEXT FOR PRODUCT: ".concat(t.displayName," ---\n");i+="Brand Name: ".concat(t.brandName||"Not provided","\n"),n&&(i+="Target Customer Cohort: ".concat(n,"\n")),i+="--------------------------------------------------\n\n";let o=(e,t)=>{t.length>0&&(i+="--- ".concat(e.toUpperCase()," ---\n"),t.forEach(e=>{let t="\n--- Item: ".concat(e.name," ---\n");e.isTextEntry&&e.textContent?t+="Content:\n".concat(e.textContent,"\n"):t+="(This is a reference to a ".concat(e.type," file named '").concat(e.name,"'. The AI should infer context from its name, type, and category.)\n"),i.length+t.length<=3e4&&(i+=t)}),i+="--- END ".concat(e.toUpperCase()," ---\n\n"))},l=r.filter(e=>"Pitch"===e.category),s=r.filter(e=>"Product Description"===e.category),a=r.filter(e=>"Pricing"===e.category),c=r.filter(e=>"Rebuttals"===e.category),d=r.filter(e=>!e.category||!["Pitch","Product Description","Pricing","Rebuttals"].includes(e.category));return o("PITCH STRUCTURE & FLOW CONTEXT (Prioritize for overall script structure)",l),o("PRODUCT DETAILS, FEATURES, & PRICING (Prioritize for benefits, features, pricing)",[...s,...a]),o("COMMON OBJECTIONS & REBUTTALS",c),o("GENERAL SUPPLEMENTARY CONTEXT",d),0===r.length&&(i+="No specific knowledge base files or text entries were found for this product.\n"),i.length>=3e4&&console.warn("Knowledge base context truncated due to length limit."),(i+="--- END OF KNOWLEDGE BASE CONTEXT ---").substring(0,3e4)})(j,a,e.customerCohort);if(r){c=!0;let e="--- START OF USER-SELECTED KB CONTEXT (PRIMARY SOURCE) ---\n";e+="File Name: ".concat(r.name,"\n"),e+="File Type: ".concat(r.type,"\n"),e+="Instruction to AI: This uploaded file ('".concat(r.name,"') is the PRIMARY knowledge source for this pitch. "),n?(e+="Its plain text content is provided below. Utilize this content directly.\n",e+="--- BEGIN UPLOADED FILE CONTENT ---\n".concat(n,"\n--- END UPLOADED FILE CONTENT ---\n"),l="Pitch generated using content from directly uploaded file: ".concat(r.name,".")):(e+="The full content of this file (type: ".concat(r.type,") was not readable on the client. Infer context from its name, type, and any other available information."),l="Pitch context from uploaded file: ".concat(r.name,". AI will attempt processing based on file name/type.")),e+="--- END OF USER-SELECTED KB CONTEXT ---\n\n",i=e+"\n--- FALLBACK GENERAL KNOWLEDGE BASE ---\n"+d}else l="Pitch generated using general Knowledge Base.",(i=d).includes("No specific knowledge base files or text entries were found")&&w({variant:"default",title:"Knowledge Base Incomplete",description:"No KB content for ".concat(s,". AI generation will be based on general knowledge."),duration:7e3});let u={product:s,brandName:a.brandName,brandUrl:a.brandUrl,customerCohort:e.customerCohort,salesPlan:e.salesPlan,offer:e.offer,agentName:e.agentName,userName:e.userName,knowledgeBaseContext:i};try{var h;let e=await (0,o.q)(u);(null==(h=e.pitchTitle)?void 0:h.startsWith("Pitch Generation Failed"))?(C(e.warmIntroduction),t(null),w({variant:"destructive",title:"Pitch Generation Failed",description:e.warmIntroduction||"The AI model encountered an issue. See error details below.",duration:1e4})):(t(e),w({title:"Pitch Generated!",description:l}));let{knowledgeBaseContext:n,...i}=u;P({module:"Pitch Generator",product:s,details:{pitchOutput:e,inputData:{...i,knowledgeBaseContextProvided:!n.includes("No specific knowledge base content found"),usedDirectFile:c,directFileName:null==r?void 0:r.name}}})}catch(i){let e=i instanceof Error?i.message:"An unexpected error occurred. Check console for details.";C(e),w({variant:"destructive",title:"Client Error Generating Pitch",description:e,duration:1e4});let{knowledgeBaseContext:t,...n}=u;P({module:"Pitch Generator",product:s,details:{error:"Client-side error: ".concat(e),inputData:{...n,knowledgeBaseContextProvided:!t.includes("No specific knowledge base content found"),usedDirectFile:c,directFileName:null==r?void 0:r.name}}})}finally{E(!1)}};return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsx)(m.z,{title:"AI Pitch Generator"}),(0,r.jsxs)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 flex flex-col items-center space-y-6",children:[(0,r.jsx)(l.P,{onSubmit:b,isLoading:n}),n&&(0,r.jsxs)("div",{className:"mt-4 flex flex-col items-center gap-2",children:[(0,r.jsx)(a.k,{size:32}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Generating your pitch..."})]}),T&&!n&&(0,r.jsxs)(c.Fc,{variant:"destructive",className:"mt-4 max-w-lg",children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),(0,r.jsx)(c.XL,{children:"Pitch Generation Error"}),(0,r.jsx)(g.nD,{type:"single",collapsible:!0,className:"w-full",children:(0,r.jsxs)(g.As,{value:"item-1",className:"border-b-0",children:[(0,r.jsx)(g.$m,{className:"p-0 hover:no-underline text-sm [&_svg]:ml-1",children:"A generation error occurred. Click to view details."}),(0,r.jsx)(g.ub,{className:"pt-2",children:(0,r.jsx)("pre",{className:"text-xs whitespace-pre-wrap break-all bg-destructive/10 p-2 rounded-md font-mono",children:T})})]})})]}),e&&!n&&(0,r.jsx)(s.r,{pitch:e}),!e&&!n&&!T&&(0,r.jsxs)(x.Zp,{className:"w-full max-w-lg shadow-sm",children:[(0,r.jsx)(x.aR,{children:(0,r.jsxs)(x.ZB,{className:"text-lg flex items-center",children:[(0,r.jsx)(u.A,{className:"h-5 w-5 mr-2 text-accent"}),"How to Use the Pitch Generator"]})}),(0,r.jsxs)(x.Wu,{className:"text-sm text-muted-foreground space-y-2",children:[(0,r.jsxs)("p",{children:["1. Select the ",(0,r.jsx)("strong",{children:"Product"})," you are creating a pitch for."]}),(0,r.jsxs)("p",{children:["2. Choose the ",(0,r.jsx)("strong",{children:"Customer Cohort"})," to tailor the pitch."]}),(0,r.jsx)("p",{children:'3. Optionally, expand "Optional Personalization Details" to specify plan, offer, and names.'}),(0,r.jsx)("p",{children:"4. For knowledge context:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside pl-4 mt-1 space-y-1",children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"Default:"}),' If no "Direct Context File" is uploaded, the AI uses relevant entries from your main ',(0,r.jsx)("strong",{children:"Knowledge Base"})," for the selected product."]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"Direct File:"})," Upload a single file (PDF, DOCX, TXT, etc.). This file becomes the primary knowledge source. The AI will prioritize its contents."]})]}),(0,r.jsxs)("p",{children:["5. Click ",(0,r.jsx)("strong",{children:"Generate Pitch"}),". The AI will craft a pitch based on the provided context."]})]})]})]})]})}}},e=>{e.O(0,[3930,5033,4909,6077,9972,8458,4037,312,2254,6241,4589,6414,6942,2410,7380,2535,355,3920,8441,1255,7358],()=>e(e.s=33733)),_N_E=e.O()}]);