(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3511],{14482:(e,t,s)=>{"use strict";function a(e){return new Promise((t,s)=>{let a=new FileReader;a.onload=()=>{"string"==typeof a.result?t(a.result):s(Error("Failed to read file as Data URL."))},a.onerror=e=>{s(e)},a.readAsDataURL(e)})}s.d(t,{zM:()=>a})},26333:(e,t,s)=>{"use strict";s.d(t,{AM:()=>l,Wv:()=>o,hl:()=>c});var a=s(95155),n=s(12115),r=s(82286),i=s(64269);let l=r.bL,o=r.l9,c=n.forwardRef((e,t)=>{let{className:s,align:n="center",sideOffset:l=4,...o}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsx)(r.UC,{ref:t,align:n,sideOffset:l,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...o})})});c.displayName=r.UC.displayName},39437:(e,t,s)=>{"use strict";s.d(t,{J:()=>d,KnowledgeBaseProvider:()=>c});var a=s(95155),n=s(67050),r=s(12115),i=s(14482);let l=[{id:"default-et-desc",name:"ET - Core Product Description",type:"text/plain",size:500,product:"ET",category:"Product Description",uploadDate:new Date().toISOString(),textContent:"ET Prime is the premium subscription service from The Economic Times, India's most respected business publication. It offers members exclusive access to deeply researched, investigative stories, and sharp, insightful analysis across more than 20 sectors. Key features include a completely ad-free reading experience on all platforms, the ET Portfolio management tool, daily stock reports, and over 25 curated sectoral newsletters. It is designed for business leaders, professionals, and serious investors who need to stay ahead of market trends and make informed decisions.",isTextEntry:!0},{id:"default-et-pitch",name:"ET - Standard Sales Pitch",type:"text/plain",size:450,product:"ET",category:"Pitch",uploadDate:new Date().toISOString(),textContent:"Hello {{userName}}, this is {{agentName}} calling from The Economic Times. I'm reaching out because our records show you've shown interest in our premium content. I wanted to take just a moment to share how an ET Prime membership can provide you with exclusive, data-driven stories and market analysis you won't find anywhere else. It's specifically designed to help professionals like you make smarter business and investment decisions. Are you familiar with our premium features?",isTextEntry:!0},{id:"default-et-pricing",name:"ET - Pricing Information",type:"text/plain",size:300,product:"ET",category:"Pricing",uploadDate:new Date().toISOString(),textContent:"We offer several flexible subscription plans for ET Prime. Our most popular option is the 1-Year plan. For greater value, we also have 2-Year and 3-Year plans that come with significant savings. Each plan provides full, unrestricted access to all ET Prime features, including our ad-free experience and exclusive content.",isTextEntry:!0},{id:"default-et-rebuttals",name:"ET - Common Rebuttals",type:"text/plain",size:600,product:"ET",category:"Rebuttals",uploadDate:new Date().toISOString(),textContent:"Objection: It's too expensive.\nRebuttal: I understand that cost is an important consideration. That's why many of our members see ET Prime not as an expense, but as an investment. The exclusive insights and analysis can help you identify opportunities or avoid risks that far outweigh the subscription cost. For example, a single insight from our stock reports could make a significant difference to your portfolio.\n\nObjection: I don't have time to read.\nRebuttal: I can certainly appreciate how busy you are, and that's exactly why ET Prime is so valuable. Our content is concise, and our newsletters provide curated briefings that save you time while keeping you informed on what truly matters in your sector. It's about getting the most critical information efficiently.",isTextEntry:!0},{id:"default-toi-desc",name:"TOI+ - Core Product Description",type:"text/plain",size:450,product:"TOI",category:"Product Description",uploadDate:new Date().toISOString(),textContent:"TOI+ is the premium digital subscription from The Times of India, offering readers access to exclusive, in-depth articles, investigative journalism, and expert opinions on the stories that matter most. It provides a deeper understanding of current events, beyond the daily news cycle. Subscribers enjoy an ad-lite experience on the website and app, along with access to over 200 exclusive stories each month and special long-form content.",isTextEntry:!0},{id:"default-toi-pitch",name:"TOI - Standard Sales Pitch",type:"text/plain",size:400,product:"TOI",category:"Pitch",uploadDate:new Date().toISOString(),textContent:"Hello {{userName}}, I'm {{agentName}} from The Times of India. I noticed you enjoy our news coverage, and I wanted to briefly introduce you to TOI+, our premium subscription service. It's for readers who want to go deeper into the stories shaping our world, with exclusive articles and expert analysis you won't find in our free content. Would you be interested in hearing more about the benefits?",isTextEntry:!0},{id:"default-toi-pricing",name:"TOI - Pricing Information",type:"text/plain",size:250,product:"TOI",category:"Pricing",uploadDate:new Date().toISOString(),textContent:"TOI+ offers flexible subscription options, including Monthly, Quarterly, and Annual plans to suit your reading habits. The Annual plan offers the best value for money, giving you a full year of unlimited access to our premium content.",isTextEntry:!0},{id:"default-toi-rebuttals",name:"TOI - Common Rebuttals",type:"text/plain",size:400,product:"TOI",category:"Rebuttals",uploadDate:new Date().toISOString(),textContent:"Objection: I get all my news for free.\nRebuttal: That's a fair point, as there is a lot of free news available. What our TOI+ members value is the trusted, in-depth analysis and exclusive stories that provide a much deeper perspective than surface-level news. It's about understanding the 'why' behind the headlines.",isTextEntry:!0}],o=(0,r.createContext)(void 0),c=e=>{let{children:t}=e,[s,c]=(0,n.M)("aiTeleSuiteKnowledgeBase_v5_with_data_uri",l);(0,r.useEffect)(()=>{if(s&&s.length>0){let e=!1,t=s.map(t=>{if(!t.isTextEntry&&t.dataUri){e=!0;let{dataUri:s,...a}=t;return a}return t});e&&(console.log("Finalizing Knowledge Base migration: Removing transient Data URIs from stored file entries."),c(t))}},[]);let d=(0,r.useCallback)(async e=>{var t;let s={id:Date.now().toString()+Math.random().toString(36).substring(2,9)+((null==(t=e.name)?void 0:t.substring(0,5))||"text"),uploadDate:new Date().toISOString(),name:(e.name||"Untitled Text Entry").substring(0,100),type:"text/plain",size:e.textContent.length,product:e.product,persona:e.persona,category:e.category||"General",textContent:e.textContent,isTextEntry:!0,dataUri:await (0,i.zM)(new Blob([e.textContent],{type:"text/plain"}))};return c(e=>[s,...e||[]].sort((e,t)=>new Date(t.uploadDate).getTime()-new Date(e.uploadDate).getTime())),s},[c]),u=(0,r.useCallback)(async e=>{let t=e.map(async(e,t)=>{var s;let a=e.file,n=await (0,i.zM)(a);return{id:Date.now().toString()+Math.random().toString(36).substring(2,9)+((null==(s=a.name)?void 0:s.substring(0,5))||"file")+t,uploadDate:new Date().toISOString(),name:a.name||"Untitled File",type:a.type||"unknown",size:a.size,product:e.product,persona:e.persona,category:e.category||((e,t)=>{let s=e.toLowerCase();return s.includes("pricing")||s.includes("price")?"Pricing":s.includes("product")&&(s.includes("desc")||s.includes("detail"))?"Product Description":s.includes("rebuttal")?"Rebuttals":s.includes("pitch")||s.includes("script")?"Pitch":"General"})(a.name,a.type),isTextEntry:!1,dataUri:n}}),s=await Promise.all(t),a=s.map(e=>{let{dataUri:t,...s}=e;return s});return c(e=>[...a,...e||[]].sort((e,t)=>new Date(t.uploadDate).getTime()-new Date(e.uploadDate).getTime())),s},[c]),m=(0,r.useCallback)(e=>{c(t=>(t||[]).filter(t=>t.id!==e))},[c]);return(0,a.jsx)(o.Provider,{value:{files:s||[],addFile:d,addFilesBatch:u,deleteFile:m,setFiles:c},children:t})};function d(){let e=(0,r.useContext)(o);if(void 0===e)throw Error("useKnowledgeBase must be used within a KnowledgeBaseProvider");return e}},42467:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Q});var a=s(95155),n=s(12115),r=s(30926);let i=(0,r.createServerReference)("40f0fd89cee17bab62815a07b94e48e73745cf56a8",r.callServer,void 0,r.findSourceMapURL,"analyzeCallBatch"),l=(0,r.createServerReference)("401799effc477a45fbd1aa1777ae81848716958bed",r.callServer,void 0,r.findSourceMapURL,"generateOptimizedPitches");var o=s(39268),c=s(65363),d=s(18332),u=s(42176),m=s(25212),p=s(5418),h=s(7545),x=s(59338),f=s(60805),g=s(15894),y=s(79313),v=s(36950),j=s(86948),w=s(3998),b=s(76444),N=s(11186),S=s(31120),C=s(31524),T=s(39437),A=s(13496),E=s(51834),I=s(40355),k=s(6943),P=s(92033),O=s(72251),D=s(73180),z=s(11647),B=s(26333),R=s(41808),F=s(90109),G=s(64269);let M=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(R.uB,{ref:t,className:(0,G.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...n})});M.displayName=R.uB.displayName;let L=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,a.jsx)(F.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,a.jsx)(R.uB.Input,{ref:t,className:(0,G.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...n})]})});L.displayName=R.uB.Input.displayName;let _=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(R.uB.List,{ref:t,className:(0,G.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...n})});_.displayName=R.uB.List.displayName;let U=n.forwardRef((e,t)=>(0,a.jsx)(R.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));U.displayName=R.uB.Empty.displayName;let K=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(R.uB.Group,{ref:t,className:(0,G.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...n})});K.displayName=R.uB.Group.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(R.uB.Separator,{ref:t,className:(0,G.cn)("-mx-1 h-px bg-border",s),...n})}).displayName=R.uB.Separator.displayName;let H=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(R.uB.Item,{ref:t,className:(0,G.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",s),...n})});H.displayName=R.uB.Item.displayName;var V=s(73457);function W(e){var t,s;let{isOpen:r,onClose:i,product:l,optimizedPitches:o,onSubmit:c,isLoading:d}=e,{addFile:u}=(0,T.J)(),{toast:m}=(0,g.dj)(),[p,h]=(0,n.useState)([]),{getProductByName:x}=(0,C.G)(),y=x(l),v=(null==y?void 0:y.customerCohorts)||[],[j,b]=(0,n.useState)(v),N=o&&o.optimizedPitches.every(e=>e.pitch.pitchTitle.includes("Error"));return(0,a.jsx)(E.lG,{open:r,onOpenChange:i,children:(0,a.jsxs)(E.Cf,{className:"sm:max-w-4xl md:max-w-5xl lg:max-w-6xl max-h-[90vh] flex flex-col p-0",children:[(0,a.jsxs)(E.c7,{className:"p-4 pb-3 border-b sticky top-0 bg-background z-10",children:[(0,a.jsxs)(E.L3,{className:"text-xl text-primary",children:["Optimized Sales Pitches for '",l,"'"]}),(0,a.jsx)(E.rr,{children:"Based on the combined call analysis, generate and review optimized pitches for selected customer cohorts."})]}),(0,a.jsxs)("div",{className:"flex-grow p-4 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"p-4 border rounded-lg bg-muted/20 space-y-3 mb-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-foreground flex items-center",children:[(0,a.jsx)(k.A,{className:"mr-2 h-5 w-5 text-primary"}),"Select Cohorts to Generate"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)($,{allCohorts:v,selectedCohorts:j,onSelectionChange:b}),(0,a.jsx)(w.$,{onClick:()=>c(j),disabled:d||0===j.length,children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.A,{className:"mr-2 h-4 w-4 animate-spin"})," Generating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Generate for (",j.length,")"]})})]})]}),d&&(0,a.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,a.jsx)(P.A,{className:"h-8 w-8 animate-spin text-primary"})}),o&&(N?(0,a.jsxs)("div",{className:"text-center py-10 text-muted-foreground",children:[(0,a.jsx)("p",{children:"Could not generate optimized pitches due to an error."}),(0,a.jsx)("p",{className:"text-xs mt-1",children:(null==(t=o.optimizedPitches[0])?void 0:t.pitch.warmIntroduction)||"Check server logs for more details."})]}):(0,a.jsx)(A.nD,{type:"multiple",defaultValue:[null==(s=o.optimizedPitches[0])?void 0:s.cohort],className:"w-full space-y-2",children:o.optimizedPitches.map((e,t)=>{let{cohort:s,pitch:n}=e;return(0,a.jsxs)(A.As,{value:s,children:[(0,a.jsx)(A.$m,{className:"text-md font-semibold hover:no-underline bg-muted/30 px-4 py-2 rounded-md",children:(0,a.jsxs)("div",{className:"flex justify-between items-center w-full pr-2",children:[(0,a.jsxs)("span",{children:["Cohort: ",s]}),n.pitchTitle.includes("Error")?(0,a.jsx)(z.E,{variant:"destructive",children:"Error"}):(0,a.jsxs)(w.$,{size:"sm",variant:"outline",onClick:e=>{let t;e.stopPropagation();let a=(t="Title: ".concat(n.pitchTitle,"\n\n")+"## Full Script\n".concat(n.fullPitchScript,"\n\n")+"## Introduction\n".concat(n.warmIntroduction,"\n\n")+"## Hook\n".concat(n.personalizedHook,"\n\n")+"## Product Explanation\n".concat(n.productExplanation,"\n\n")+"## Key Benefits\n".concat(n.keyBenefitsAndBundles,"\n\n")+"## Offer\n".concat(n.discountOrDealExplanation,"\n\n")+"## Objection Previews\n".concat(n.objectionHandlingPreviews,"\n\n")+"## Call to Action\n".concat(n.finalCallToAction,"\n\n"),n.notesForAgent&&(t+="## Agent Notes\n".concat(n.notesForAgent,"\n")),t),r="Optimized Pitch: ".concat(n.pitchTitle);u({name:r,type:"text/plain",size:a.length,product:l,persona:s,category:"Pitch",textContent:a,isTextEntry:!0}),h(e=>[...e,s]),m({title:"Pitch Saved to Knowledge Base",description:'"'.concat(r,'" saved for cohort: ').concat(s,".")})},disabled:p.includes(s),children:[p.includes(s)?(0,a.jsx)(O.A,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4"}),p.includes(s)?"Saved":"Save to KB"]})]})}),(0,a.jsx)(A.ub,{className:"pt-3 px-1",children:(0,a.jsx)(I.r,{pitch:n})})]},"".concat(s,"-").concat(t))})}))]}),(0,a.jsx)(E.Es,{className:"p-3 border-t bg-muted/50 sticky bottom-0",children:(0,a.jsx)(w.$,{onClick:i,size:"sm",children:"Close"})})]})})}let $=e=>{let{allCohorts:t,selectedCohorts:s,onSelectionChange:n}=e;return(0,a.jsxs)(B.AM,{children:[(0,a.jsx)(B.Wv,{asChild:!0,children:(0,a.jsxs)(w.$,{variant:"outline",className:"w-[250px] justify-start",children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4"}),s.length>0?"".concat(s.length," selected"):"Select cohorts..."]})}),(0,a.jsx)(B.hl,{className:"w-[250px] p-0",align:"start",children:(0,a.jsxs)(M,{children:[(0,a.jsx)(L,{placeholder:"Filter cohorts..."}),(0,a.jsxs)(_,{children:[(0,a.jsx)(U,{children:"No cohorts found."}),(0,a.jsxs)(K,{children:[(0,a.jsxs)(H,{onSelect:()=>{s.length!==t.length?n(t):n([])},className:"flex items-center space-x-2",children:[(0,a.jsx)(V.S,{checked:s.length===t.length}),(0,a.jsx)("span",{children:"Select All"})]}),t.map(e=>(0,a.jsxs)(H,{onSelect:()=>((e,t)=>{t?n([...s,e]):n(s.filter(t=>t!==e))})(e,!s.includes(e)),className:"flex items-center space-x-2",children:[(0,a.jsx)(V.S,{checked:s.includes(e)}),(0,a.jsx)("span",{children:e})]},e))]})]})]})})]})};var Z=s(17037),J=s(86259),Y=s(87270),q=s(5282),X=s(19056);function Q(){let[e,t]=(0,n.useState)(null),[s,r]=(0,n.useState)([]),[E,I]=(0,n.useState)(!1),[k,P]=(0,n.useState)(!1),[O,D]=(0,n.useState)(""),[z,B]=(0,n.useState)(null),[R,F]=(0,n.useState)(),[G,M]=(0,n.useState)(""),[L,_]=(0,n.useState)("All"),[U,K]=(0,n.useState)(null),[H,V]=(0,n.useState)(!1),{toast:$}=(0,g.dj)(),{logActivity:Z,activities:Y}=(0,y.Z)(),{availableProducts:q,getProductByName:X}=(0,C.G)(),{files:Q}=(0,T.J)(),et=(0,n.useMemo)(()=>{if(!R)return[];let e=(Y||[]).filter(e=>{var t,s;return("Call Scoring"===e.module&&e.details.scoreOutput||("AI Voice Sales Agent"===e.module||"Browser Voice Agent"===e.module)&&e.details.finalScore)&&(e.product===R||(null==(t=e.details.input)?void 0:t.product)===R||(null==(s=e.details.flowInput)?void 0:s.product)===R)&&e.details&&"object"==typeof e.details}).map(e=>{let t,s,a;if("Call Scoring"===e.module)t=e.details.scoreOutput,s=e.details.fileName,a="Manual Score";else{var n,r;t=e.details.finalScore,s="Voice Call - ".concat((null==(n=e.details.input)?void 0:n.userName)||(null==(r=e.details.flowInput)?void 0:r.userName)||"User"),a="Voice Agent Score"}return t&&"Error"!==t.callCategorisation&&s?(t.timestamp||(t.timestamp=e.timestamp),{id:e.id,fileName:s,scoreOutput:t,type:a}):null}).filter(e=>null!==e).sort((e,t)=>{var s,a;let n=(null==(s=e.scoreOutput)?void 0:s.timestamp)?new Date(e.scoreOutput.timestamp).getTime():0;return((null==(a=t.scoreOutput)?void 0:a.timestamp)?new Date(t.scoreOutput.timestamp).getTime():0)-n});return"All"===L?e:e.filter(e=>e.type===L)},[R,Y,L]);(0,n.useCallback)(()=>{r([])},[R,L]);let es=async()=>{I(!0),B(null),t(null),K(null);let e=et.filter(e=>s.includes(e.id));try{if(e.length<2)throw Error("At least 2 valid reports are required for a combined analysis. You have selected ".concat(e.length,"."));D("Found ".concat(e.length," items. Generating combined analysis..."));let s={callReports:e.map(e=>{let{id:t,type:s,...a}=e;return a}),product:R,overallAnalysisGoal:G},a=await i(s);if(t(a),a.reportTitle.startsWith("Error:")||a.reportTitle.startsWith("Critical Error:"))throw Error(a.batchExecutiveSummary||"The AI returned an error during combined analysis.");$({title:"Combined Analysis Complete!",description:"Aggregated report is ready."}),Z({module:"Combined Call Analysis",product:R,details:{input:s,output:a}})}catch(t){let e=t.message||"Unknown error during analysis.";B("Analysis failed: ".concat(e)),$({variant:"destructive",title:"Analysis Failed",description:e})}finally{I(!1),D("")}},ea=async t=>{if(!e||!R)return void $({variant:"destructive",title:"Error",description:"A combined report must be generated first."});let s=X(R);if(!s)return void $({variant:"destructive",title:"Error",description:"Selected product details not found."});P(!0);try{let a=((e,t)=>{if(!e||!Array.isArray(e))return"Knowledge Base not yet loaded.";let s=e.filter(e=>e.product===t.name);if(0===s.length)return"No specific knowledge base content found for this product.";let a="Knowledge Base Context for Product: ".concat(t.displayName,"\n---\n");for(let e of s){let t="(File: ".concat(e.name,", Type: ").concat(e.type,". Content not directly viewed for non-text or large files; AI should use name/type as context.)");e.isTextEntry&&e.textContent&&(t=e.textContent.substring(0,2e3)+(e.textContent.length>2e3?"...":""));let s="Item: ".concat(e.name,"\nType: ").concat(e.isTextEntry?"Text Entry":"File","\nCategory: ").concat(e.category||"General","\nContent Summary/Reference:\n").concat(t,"\n---\n");if(a.length+s.length>15e3){a+="... (Knowledge Base truncated due to length limit for AI context)\n";break}a+=s}return a})(Q,s),n=await l({product:R,cohortsToOptimize:t,analysisReport:e,knowledgeBaseContext:a});if(!n||!n.optimizedPitches||n.optimizedPitches.some(e=>e.pitch.pitchTitle.includes("Error"))){let e=null==n?void 0:n.optimizedPitches.find(e=>e.pitch.pitchTitle.includes("Error"));throw Error((null==e?void 0:e.pitch.warmIntroduction)||"An unexpected error occurred during pitch generation.")}K(n),$({title:"Pitches Generated!",description:"Optimized pitches for ".concat(t.length," cohort(s) are ready.")})}catch(e){$({variant:"destructive",title:"Pitch Generation Failed",description:e.message,duration:8e3}),K(null)}finally{P(!1),V(!0)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)(v.z,{title:"Combined Call Scoring Analysis"}),(0,a.jsxs)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 flex flex-col items-center space-y-6",children:[(0,a.jsxs)(j.Zp,{className:"w-full max-w-4xl shadow-lg",children:[(0,a.jsxs)(j.aR,{children:[(0,a.jsxs)(j.ZB,{className:"text-xl flex items-center",children:[(0,a.jsx)(u.A,{className:"mr-2 h-6 w-6 text-primary"}),(0,a.jsx)("span",{children:"Configure Analysis"})]}),(0,a.jsx)(j.BT,{children:"Select a product and set an optional goal to begin your combined analysis."})]}),(0,a.jsxs)(j.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(b.J,{htmlFor:"product-select",className:"font-semibold",children:["Step 1: Select Product Focus ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsxs)(N.l6,{value:R,onValueChange:e=>{F(e),r([]),t(null)},children:[(0,a.jsx)(N.bq,{id:"product-select",children:(0,a.jsx)(N.yv,{placeholder:"Select a product"})}),(0,a.jsx)(N.gC,{children:q.map(e=>(0,a.jsx)(N.eb,{value:e.name,children:e.displayName},e.name))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(b.J,{htmlFor:"analysis-goal",className:"font-semibold",children:"Step 2: Set Analysis Goal (Optional)"}),(0,a.jsx)(S.T,{id:"analysis-goal",placeholder:"e.g., 'Focus on why pricing objections are leading to lost sales'",rows:1,value:G,onChange:e=>M(e.target.value)})]})]})]}),R&&(0,a.jsxs)(j.Zp,{className:"w-full max-w-4xl",children:[(0,a.jsx)(j.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(j.ZB,{className:"text-lg font-semibold flex items-center",children:"Step 3: Select Reports for Analysis"}),(0,a.jsx)(j.BT,{children:"Choose at least 2 historical reports to include in the combined analysis."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.J,{htmlFor:"source-filter",className:"text-sm",children:"Source:"}),(0,a.jsxs)(N.l6,{value:L,onValueChange:e=>_(e),children:[(0,a.jsx)(N.bq,{id:"source-filter",className:"w-[200px]",children:(0,a.jsx)(N.yv,{placeholder:"Filter by source"})}),(0,a.jsxs)(N.gC,{children:[(0,a.jsx)(N.eb,{value:"All",children:"All Sources"}),(0,a.jsx)(N.eb,{value:"Manual Score",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Manual Score"]})}),(0,a.jsx)(N.eb,{value:"Voice Agent Score",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 mr-2"}),"Voice Agent Score"]})})]})]})]})]})}),(0,a.jsx)(j.Wu,{children:(0,a.jsx)(ee,{reports:et,selectedIds:s,onSelectionChange:r})}),(0,a.jsx)(j.wL,{className:"bg-muted/50 border-t px-6 py-4",children:(0,a.jsx)(w.$,{onClick:es,className:"w-full text-base py-6",disabled:E||!R||s.length<2,children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.k,{className:"mr-2"}),O||"Analyzing..."]}):"Run Combined Analysis on ".concat(s.length," Reports")})})]}),z&&!E&&(0,a.jsxs)(d.Fc,{variant:"destructive",className:"mt-4 max-w-lg",children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),(0,a.jsx)(d.XL,{children:"Analysis Error"}),(0,a.jsx)(A.nD,{type:"single",collapsible:!0,className:"w-full",children:(0,a.jsxs)(A.As,{value:"item-1",className:"border-b-0",children:[(0,a.jsx)(A.$m,{className:"p-0 hover:no-underline text-sm [&_svg]:ml-1",children:"Details"}),(0,a.jsx)(A.ub,{className:"pt-2",children:(0,a.jsx)("pre",{className:"text-xs whitespace-pre-wrap break-all bg-destructive/10 p-2 rounded-md font-mono",children:z})})]})})]}),e&&!E&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(J.w,{className:"w-full max-w-4xl my-4"}),(0,a.jsx)(o.e,{report:e,individualScores:et.filter(e=>s.includes(e.id))}),(0,a.jsx)(j.Zp,{className:"w-full max-w-5xl",children:(0,a.jsx)(j.wL,{className:"pt-6",children:(0,a.jsxs)("div",{className:"w-full flex flex-col items-center gap-2",children:[(0,a.jsxs)("p",{className:"text-sm font-semibold text-primary flex items-center",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 mr-2 text-accent"}),"Next Step: Turn Insights into Action"]}),(0,a.jsxs)(w.$,{onClick:()=>V(!0),variant:"default",className:"w-full bg-gradient-to-r from-primary to-accent text-primary-foreground",disabled:k,children:[k?(0,a.jsx)(c.k,{size:16,className:"mr-2"}):(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"}),k?"Generating Optimized Pitches...":"Generate Optimized Pitches from This Analysis"]})]})})})]})]})]}),e&&(0,a.jsx)(W,{isOpen:H,onClose:()=>V(!1),product:R,optimizedPitches:U,onSubmit:ea,isLoading:k})]})}function ee(e){let{reports:t,selectedIds:s,onSelectionChange:n}=e,r=t.length>0&&s.length===t.length;return(0,a.jsx)(Z.F,{className:"h-72 border rounded-md",children:(0,a.jsxs)(Y.XI,{children:[(0,a.jsx)(Y.A0,{className:"sticky top-0 bg-muted/50",children:(0,a.jsxs)(Y.Hj,{children:[(0,a.jsx)(Y.nd,{className:"w-[50px]",children:(0,a.jsx)(V.S,{checked:r,onCheckedChange:e=>{n(e?t.map(e=>e.id):[])},"aria-label":"Select all rows"})}),(0,a.jsx)(Y.nd,{children:"Report Name / Source"}),(0,a.jsx)(Y.nd,{children:"Type"}),(0,a.jsx)(Y.nd,{children:"Score"}),(0,a.jsx)(Y.nd,{children:"Date"})]})}),(0,a.jsx)(Y.BF,{children:0===t.length?(0,a.jsx)(Y.Hj,{children:(0,a.jsx)(Y.nA,{colSpan:5,className:"h-24 text-center text-muted-foreground",children:"No historical reports found for this product and source filter."})}):t.map(e=>{var t,r,i,l;return(0,a.jsxs)(Y.Hj,{"data-state":s.includes(e.id)?"selected":void 0,children:[(0,a.jsx)(Y.nA,{children:(0,a.jsx)(V.S,{checked:s.includes(e.id),onCheckedChange:t=>{var a;return a=e.id,void(t?n([...s,a]):n(s.filter(e=>e!==a)))},"aria-label":"Select report ".concat(e.fileName)})}),(0,a.jsx)(Y.nA,{className:"font-medium max-w-xs truncate",title:e.fileName,children:e.fileName}),(0,a.jsx)(Y.nA,{children:(0,a.jsxs)(z.E,{variant:"Manual Score"===e.type?"outline":"secondary",children:["Manual Score"===e.type?(0,a.jsx)(m.A,{className:"w-3 h-3 mr-1.5"}):(0,a.jsx)(p.A,{className:"w-3 h-3 mr-1.5"}),e.type]})}),(0,a.jsx)(Y.nA,{children:(0,a.jsxs)(z.E,{variant:"secondary",className:"font-mono",children:[null!=(l=null==(r=e.scoreOutput)||null==(t=r.overallScore)?void 0:t.toFixed(1))?l:"N/A"," / 5.0"]})}),(0,a.jsx)(Y.nA,{className:"text-xs text-muted-foreground",children:(null==(i=e.scoreOutput)?void 0:i.timestamp)?(0,q.GP)((0,X.H)(e.scoreOutput.timestamp),"PP"):"Invalid Date"})]},e.id)})})]})})}},65363:(e,t,s)=>{"use strict";s.d(t,{k:()=>i});var a=s(95155),n=s(92033),r=s(64269);function i(e){let{size:t=24,className:s}=e;return(0,a.jsx)(n.A,{style:{width:t,height:t},className:(0,r.cn)("animate-spin text-primary",s)})}},73457:(e,t,s)=>{"use strict";s.d(t,{S:()=>o});var a=s(95155),n=s(12115),r=s(38162),i=s(72251),l=s(64269);let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.bL,{ref:t,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...n,children:(0,a.jsx)(r.C1,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})})});o.displayName=r.bL.displayName},94395:(e,t,s)=>{Promise.resolve().then(s.bind(s,42467))}},e=>{e.O(0,[2581,3930,5033,4909,6077,9972,6107,8458,4037,312,2254,6241,4589,2558,546,2362,2410,7380,2535,710,355,1841,8441,1255,7358],()=>e(e.s=94395)),_N_E=e.O()}]);